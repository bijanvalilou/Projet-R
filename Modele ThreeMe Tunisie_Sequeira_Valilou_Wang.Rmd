---
title: "Model ThreeMe Tunisia"
author: "Lucia SEQUEIRA - Bijan VALILOU - Jin WANG"
date: "February 2022"
output:
  pdf_document:
    citation_package: biblatex
    toc: yes
    number_sections: yes
    toc_depth: 4
    highlight: tango
    latex_engine: lualatex
    fig_caption: yes
  html_document:
    toc: yes
    toc_depth: 5
  word_document:
    toc: yes
    toc_depth: '5'
subtitle: 'Macroeconomic impacts of National Low-Carbon Strategy for a little country
  in development : the case of Tunisia'
header-includes:
- \usepackage{fancyhdr}
- \pagestyle{fancy}
- \fancyfoot[CO,CE]{Modèle ThreeMe Tunisie}
- \fancyfoot[LE,RO]{\thepage}
bibliography: references.bib
---

```{r, echo = FALSE, tidy = TRUE, include = FALSE}

# Importer des packages
library(knitr) 
library(rmarkdown) 
library(markdown) 
library(readxl)
library(tibble)
library(ggplot2)
library(dplyr)
library(usethis)
library(kableExtra)
library(ggpubr)
library(forcats)
library(cowplot)
library(gridExtra)
```

```{r, echo = FALSE, tidy = TRUE, include = FALSE}

# Importer de la base de données
sheet_names <- excel_sheets("Page Reporting_shock des scénarios.xlsx")
nb_sheets <- length(sheet_names)
for (i in 1:nb_sheets){  
        name <- sheet_names[i] 
        name2 <- paste0(name) 
        data <- read_excel("Page Reporting_shock des scénarios.xlsx", sheet = i) 
        data <- column_to_rownames(data, var = '_date_')
        colnames(data) <- c(2015:2050)
        data <- data.frame(t(data))
        data$year <- c(2015:2050)
        assign(name2,data)
        rm(name,name2,data)
} 

Sc1 <- (S1/Baseline-1)*100
Sc2 <- (S2/Baseline-1)*100
Sc3 <- (S3/Baseline-1)*100
Sc4 <- (S4/Baseline-1)*100
Sc5 <- (S5/Baseline-1)*100
Sc6 <- (S6/Baseline-1)*100
Sc1$year <- c(2015:2050)
Sc2$year <- c(2015:2050)
Sc3$year <- c(2015:2050)
Sc4$year <- c(2015:2050)
Sc5$year <- c(2015:2050)
Sc6$year <- c(2015:2050)

sheet_names <- excel_sheets("Page Macro.xlsx")
nb_sheets <- length(sheet_names)
for (i in 1:nb_sheets){  
        name <- sheet_names[i] 
        name2 <- paste0(name,"_Macro") 
        data <- read_excel("Page Macro.xlsx", sheet = i) 
        data <- column_to_rownames(data, var = '_date_')
        colnames(data) <- c(2015:2050)
        data <- data.frame(t(data))
        data$year <- c(2015:2050)
        assign(name2,data)
        rm(name,name2,data)
} 


sheet_names <- excel_sheets("Sectors and commodities_MissingData.xlsx")
nb_sheets <- length(sheet_names)
for (i in 2:nb_sheets){  
        name <- sheet_names[i] 
        name2 <- paste0(name,sep="") 
        data <- read_excel("Sectors and commodities_MissingData.xlsx", sheet = i) 
        data <- column_to_rownames(data, var = 'Year')
        colnames(data) <- c(2015:2050)
        data <- data.frame(t(data))
        data$year <- c(2015:2050)
        assign(name2,data)
        rm(name,name2,data)
} 
```

```{r, echo=FALSE, tidy = TRUE, include = FALSE}

sc <- c("KAYA_1","KAYA_2","KAYA_3","KAYA_4","KAYA_5","KAYA_6")
kayaname <- c("S_ind","S_trsp","S_ser","S_trsf","S_ele","E_ind","E_trsp","E_ser","E_trsf","E_ele","I_ind","I_trsp","I_ser","I_trsf","I_ele","V")
va <- c("va_ind_2","va_trsp_2","va_ser_2","va_trsf_2","va_ele_2","ci_toe_ind_2","ci_toe_trsp_2","ci_toe_ser_2","ci_toe_trsf_2","ci_toe_ele_2","ems_ci_co2_ind_2","ems_ci_co2_trsp_2","ems_ci_co2_ser_2","ems_ci_co2_trsf_2","ems_ci_co2_ele_2","year","va_2")
va_0 <- c("va_ind_0","va_trsp_0","va_ser_0","va_trsf_0","va_ele_0","ci_toe_ind_0","ci_toe_trsp_0","ci_toe_ser_0","ci_toe_trsf_0","ci_toe_ele_0","ems_ci_co2_ind_0","ems_ci_co2_trsp_0","ems_ci_co2_ser_0","ems_ci_co2_trsf_0","ems_ci_co2_ele_0","year","va_0")


DataBase <- list(S1,S2,S3,S4,S5,S6)

for (i in 1:6) {
  DataBase[[i]][,"ems_ci_co2_trsf_2"] <- DataBase[[i]][,"ems_ci_co2_trsf_2"] + DataBase[[i]][,"ems_ch_co2_2"]
  DataBase[[i]][,"ci_toe_trsf_2"] <- DataBase[[i]][,"ci_toe_trsf_2"] + DataBase[[i]][,"ch_toe_2"]
}



for (j in 1:6) {

data <- as.data.frame(array(,dim=c(36,16)))

for (i in 1:15) {
  if (i < 6) {
  temp <- DataBase[[j]][,va[i]]/DataBase[[j]][,va[17]]
  data[,i] <- temp
  }
  else if(i < 11) {
  temp <- DataBase[[j]][,va[i]]/DataBase[[j]][,va[i-5]]
  data[,i] <- temp
  }
  else if(i < 16) {
  temp <- DataBase[[j]][,va[i]]/DataBase[[j]][,va[i-5]]
  data[,i] <- temp
  }
}
data[,16] = DataBase[[j]][,va[17]]
colnames(data) = kayaname
assign(sc[j],data)
rm(data,temp)

}

data <- as.data.frame(array(,dim=c(36,16)))

Base <- Baseline
Base[,"ems_ci_co2_trsf_0"] <- Base[,"ems_ci_co2_trsf_0"] + Base[,"ems_ch_co2_0"] 
Base[,"ci_toe_trsf_0"] <- Base[,"ci_toe_trsf_0"] + Base[,"ch_toe_0"] 

for (i in 1:15) {
  if (i < 6) {
  temp <- Base[,va_0[i]]/Base[,va_0[17]]
  data[,i] <- temp
  }
  else if(i < 11) {
  temp <- Base[,va_0[i]]/Base[,va_0[i-5]]
  data[,i] <- temp
  }
  else if(i < 16) {
  temp <- Base[,va_0[i]]/Base[,va_0[i-5]]
  data[,i] <- temp
  }
}
data[,16] = Baseline[,va_0[17]]
colnames(data) = kayaname
assign("KAYA_Baseline",data)

Kaya_Base <- list(KAYA_1,KAYA_2,KAYA_3,KAYA_4,KAYA_5,KAYA_6)

rm(data,temp,i,j,sc,va,va_0,kayaname)
# Fin de creation de la base de donnees

```

```{r, echo=FALSE, tidy = TRUE, include = FALSE}
# Decomposition multiplicative

name <- c("D1","D2","D3","D4","D5","D6")
secteur <- c("ems_ci_co2_ind_2","ems_ci_co2_trsp_2","ems_ci_co2_ser_2","ems_ci_co2_trsf_2","ems_ci_co2_ele_2")
secteur0 <- c("ems_ci_co2_ind_0","ems_ci_co2_trsp_0","ems_ci_co2_ser_0","ems_ci_co2_trsf_0","ems_ci_co2_ele_0")
kayaname <- c("S_ind","S_trsp","S_ser","S_trsf","S_ele","E_ind","E_trsp","E_ser","E_trsf","E_ele","I_ind","I_trsp","I_ser","I_trsf","I_ele","V","ind","trsp","ser","trsf","ele","S","E","I")

for (i in 1:6) {
  
  w <- as.data.frame(array(,dim=c(36,16)))
  for (j in 1:5) {
  w[,c(j,j+5,j+10)] <- ((DataBase[[i]][,secteur[j]]-Base[,secteur0[j]])/
          log(DataBase[[i]][,secteur[j]]/Base[,secteur0[j]]))/
     ((DataBase[[i]][,"ems_co2_2"] - Base[,"ems_co2_0"])/
       log(DataBase[[i]][,"ems_co2_2"]/Base[,"ems_co2_0"]))
  }
  w[,16] <- w[,1]+ w[,2]+ w[,3]+ w[,4]+ w[,5]
  data <- exp(w*log(Kaya_Base[[i]]/KAYA_Baseline))
  data <- rapply( data, f=function(x) ifelse(is.nan(x),1,x), how="replace" )
  
  for (k in 1:8) {
    if (k < 6) {
      data <- data %>% add_column(newColname = data[,k] * data[,k+5] * data[,k+10]) 
    }
    else if (k == 6) {
      data <- data %>% add_column(newColname = data[,k-5]*data[,k-4]*data[,k-3]*data[,k-2]*data[,k-1]) 
    }
    else if (k == 7) {
      data <- data %>% add_column(newColname = data[,k-1]*data[,k]*data[,k+1]*data[,k+2]*data[,k+3]) 
    }
    else if (k == 8) {
      data <- data %>% add_column(newColname = data[,k+3]*data[,k+4]*data[,k+5]*data[,k+6]*data[,k+7]) 
    }
  }
  
  colnames(data) <- kayaname
  data <- (data - 1) * 100
  data$year <- c(2015:2050)
  jin <- name[i]
  assign(jin,data)
}

Det <- list(D1,D2,D3,D4,D5,D6)

rm(i,j,jin,name,kayaname,secteur,secteur0,w,data,D1,D2,D3,D4,D5,D6)
```

```{r, echo=FALSE, tidy = TRUE, include = FALSE}
# Decomposition additive
name <- c("D1","D2","D3","D4","D5","D6")
secteur <- c("ems_ci_co2_ind_2","ems_ci_co2_trsp_2","ems_ci_co2_ser_2","ems_ci_co2_trsf_2","ems_ci_co2_ele_2")
secteur0 <- c("ems_ci_co2_ind_0","ems_ci_co2_trsp_0","ems_ci_co2_ser_0","ems_ci_co2_trsf_0","ems_ci_co2_ele_0")
kayaname <- c("S_ind","S_trsp","S_ser","S_trsf","S_ele","E_ind","E_trsp","E_ser","E_trsf","E_ele","I_ind","I_trsp","I_ser","I_trsf","I_ele","V","ind","trsp","ser","trsf","ele","S","E","I")

for (i in 1:6) {
  
  w <- as.data.frame(array(,dim=c(36,16)))
  
  for (j in 1:5) {
    w[,c(j,j+5,j+10)] <- (DataBase[[i]][,secteur[j]]-Base[,secteur0[j]])/
          log(DataBase[[i]][,secteur[j]]/Base[,secteur0[j]])
  }
  
  w[,16] <- w[,1]+ w[,2]+ w[,3]+ w[,4]+ w[,5]
  data <- w*log(Kaya_Base[[i]]/KAYA_Baseline)
  data <- rapply( data, f=function(x) ifelse(is.nan(x),0,x), how="replace" )
  
  for (k in 1:8) {
    if (k < 6) {
      data <- data %>% add_column(newColname = data[,k] + data[,k+5] + data[,k+10]) 
    }
    else if (k == 6) {
      data <- data %>% add_column(newColname = data[,k-5]+data[,k-4]+data[,k-3]+data[,k-2]+data[,k-1]) 
    }
    else if (k == 7) {
      data <- data %>% add_column(newColname = data[,k-1]+data[,k]+data[,k+1]+data[,k+2]+data[,k+3]) 
    }
    else if (k == 8) {
      data <- data %>% add_column(newColname = data[,k+3]+data[,k+4]+data[,k+5]+data[,k+6]+data[,k+7]) 
    }
  }
  
  colnames(data) <- kayaname
  data$year <- c(2015:2050)
  jin <- name[i]
  assign(jin,data)
}

Dif <- list(D1,D2,D3,D4,D5,D6)

rm(i,j,jin,name,secteur,secteur0,w,data,D1,D2,D3,D4,D5,D6)
```

\newpage

# Introduction - Energy and economy framework in Tunisia

Tunisia is one of the northernmost countries in Africa, ranked the most competitive economy in Africa by World Economy Forum in 2009 [@tunisia2022]. The local economy is largely oriented towards services, which account for 43% of GDP in 2019 [@worldbank2020], including the booming IT and tourism industries. Agriculture is another key sector of the Tunisian economy, representing 10.4% of the GDP and employing 12.7% of the working population [@worldbank2020]. Thanks to technical progress of agricultural sector, Tunisia is one of the most productive countries in Africa. Tunisia's industry represents 22.7% of GDP and employs 32.5% of the working population in 2020 [@bnpparibas]. The industrial sectors are mainly export oriented especially for manufacturing, Europe is the destination for more than 75% of Tunisia's exports [@worldbank2020].

Since the Jasmine Revolution on 2011, Tunisia economy has been suffered from the extended recession. The sanitary crisis on 2020 has worsened the already precarious situation. Actually, even before COVID-19 Tunisia's capacity for economic resilience had been drained by years of indecisive public policy-making and growing protectionism [@worldbank]. In early September 2020, the Tunisian parliament finally reversed a government of Tenchnocrats in an attempt to remedy the country's economic situation [@bnpparibas].

Along with the sluggish economy is the huge energy deficit in Tunisia. @irena2021 reported that energy deficit (50% in 2019) has existed in Tunisia over the past two decades, mainly because of the increasing consumption but with the stagnated even declined domestic production in recent years. @giz reported that Tunisia depends for 60% on energy imports, and this number is continuously raising. The energy transition project proclaimed in 2014 aims to reduce energy needs by 34% by 2030, lower subsidies and establish incentive mechanisms favoring profitable and climate friendly investments. However, the challenging is the lack of reliable institutional mechanisms and motivation for enterprises to participate, accompanied with a poorly established service market and weak transmission of knowledge to citizens, especially outside urban area.

The welfare system is based on non-targeted subsidies. According to @albertin2014, the subsidy policy is a pillar of the Tunisian welfare system. Targeted social assistance programs are above the regional average. In 2016, social expenditure represented 3.2 percent of GDP, majority of which was energy and food subsidies [@tunisia2020]. In 2021, the fossil fuel subsidies amounted to \$1,14 billion (2.7% of GDP) [@trésor2021]. Concerning energy subsidies, the government subsidizes liquefied petroleum gas (LPG), natural gas, kerosene, diesel, gasoline, electricity and heavy fuel oil. The effective subsidies by product are represented in figure 1. The LPG and the electricity subsidies are the main expenditure items as shown in figure 2. A significant part of the energy subsidies are captured by the wealthiest quintile of the population. On the contrary, in 2013, the bottom 40% of the distribution captured only 29% of energy subsidies [@worldbank2014]. According to @cuesta2017 , energy subsidies are also a cornerstone of the development of Tunisian productive sectors. The subsidy system allows firms to buy cheap energy resources. The noncompetitive companies, which employ unskilled workers, rely on the subsidies.

After the revolution, fiscal and equity issues incited the Tunisian government to reduce energy subsidies. In 2012, the prices of gasoline, diesel and electricity increased by 7% [@albertin2014]. In 2014, energy subsidies to cement firms were reduced by half. In 2020, Tunisia has introduced an automatic monthly price adjustment mechanism for petrol and diesel sales, with the aim of eliminating fuel subsidies.

![](Images/Composition%20of%20fuel%20subsidies%20by%20product.jpg)

::: {align="center"}
Fig.1 : Composition of fuel subsidies product (source : @tunisia2020)
:::

![](Images/Energy%20subsdies%20received%20by%20welfare%20quintile.jpg)

::: {align="center"}
Fig.2 : Energy subsidies received by welfare quintile, 2015/16 (TND millions) (source : @tunisia2020)
:::

In its Nationally Determined Contribution, Tunisia commits to reducing its carbon intensity by 41% in 2030 compared to the base year 2010. In order to reach this objective, Tunisia has a range of policies to implement: carbon tax, lifting of subsidies and development of renewable energies. With the the ThreeMe Tunisia model, we intend to answer the following question : **what are the macroeconomic, technological and environmental repercussions of the policies? And whether they should be implemented separately or together ?**

After a literature review (II), the methodology based on the combination of scenarios, the ThreeMe Tunisia model and the extended Kaya identity is presented (III). The outputs per scenario of the ThreeMe Tunisia model are analysed, notably thanks to the extended Kaya identity (IV).

# Literature review in climate policy

## Carbon tax

In general, the presence of an environmental externality suggests that there is a marginal social cost that exceeds the marginal private cost. In the absence of regulation, the difference between this two costs (the marginal external cost of damage) is not covered by the polluter. Consider the particular case of the externalities associated with the release of CO2 in the atmosphere. The carbon tax is the tax that comes reflect that marginal external damage.

The advantage of using a tax system to price environmental harm is to send a clear price signal to guide economic entities spontaneously to reduce their level of pollution, until their marginal cost of depollution equals the tax [@deperthuis2010] .

After some reversals over the past twenty years, carbon pricing is reemerging. Since 2016, many new carbon-pricing initiatives have been implemented, with several countries considering implementing carbon pricing in the years ahead, after having signed the Paris Agreement [@klenert2018]. The level of the carbon price retained, i.e. the rate of the tax, corresponds in someway to the value that society places on the protection of the environment from the consequences of a rise in temperature [@deperthuis2010].

In a competitive market, the introduction of a carbon tax will cause private costs to rise and in consequence its implementation encounters considerable resistance. It is then desirable to accompany carbon taxes with some mechanism that enhance its acceptability.

## Energy subsidy

Subsidies are defined by @demoor1997 as *'any measure that keeps prices for consumers below the market level or keeps prices for producers above the market level or that reduces costs for consumers and producers by giving direct or indirect support'*. Energy subsidies are a common policy. Their amount is estimated at \$4.7 trillion in 2015 as pointed out @coady2019, which is equivalent to 6.3 percent of Gross Domestic Product . Energy subsidies fluctuate depending on the price of the energy products. From the database of the International Energy Agency, we can notice that the fossil fuel subsidies have [fallen by 42 percent between 2019 and 2020](https://www.iea.org/topics/energy-subsidies) due to the drop of fuel prices.

The energy subsidies are very present in the Middle East, North Africa, Afghanistan and Pakistan region (MENAP). According to @coady2019, MENAP is the fourth region in absolute terms, which subsidized the most energy in 2015. Nevertheless, in relative terms, MENAP is the second, if we take into account the percent of its GDP. The prevalence of energy subsidies in MENAP can be explained by the post-par period. These energy subsidies were introduced, after the decolonization, in Middle East and North Africa region (MENA) in order to stabilize prices and then, became a social protection system [@verme2017].

@fattouh2013 emphasize three positive aspects of the energy subsidies that we saw above :

-   The energy subsidies enhance the incomes of the poorest part of the population. It constitute a core part of the welfare system in the MENA.

-   The energy subsidies help to reduce production costs and to strengthen competitiveness of local firms. Energy subsidies are a tool for industrialization and diversification policy.

-   The regulation of energy prices is used to control inflation and stabilize prices.

Reducing energy subsidies may improve economic welfare and reduce emissions [@aldy2013 ; @coady2019 ; @hahn2021]. @fattouh2013 also highlight unintended consequences of energy subsidies :

-   Energy subsidies raise energy intensity of GDP and reduce energy efficiency rates. Low energy pricing favors the growth of energy-intensive industries and discourage the firms from minimizing energy costs. Fig. 3 below shows that many energy-intensive countries have also high fossil fuel subsidies as a proportion of their GDP.
-   Energy subsidies distort consumption. Indeed, they cause a fast growth in consumption of primary fuels and electricity. According to @fattouh2013, between 1980 to 2008, the total energy consumption in MENA grew more than 5% annually.
-   Energy subsidies distort investments. The weak implementation of subsidies provoke underinvestment in energy sectors, where the subsidies do not entirely compensate the energy companies. Therefore, end users receive a low quality service.
-   Energy subsides cause fuel shortages because of low prices. The smuggling across borders is also favored by the price differences between countries.
-   Non-targeted subsidies create inequities between social groups (see fig. 2 above).

![](Images/Subsidies%20-%20energy%20intensity.jpg)

::: {align="center"}
Fig.3 : Energy subsidies and energy intensities by country in 2017 (data : SDG indicators for United Nations Economic Commission for Europe)
:::

## Carbon tax revenue recycling and double dividend

Tax redistribution is the mechanism that allows the government to return to the private economy the revenues that are produced by the instrument [@goulder2013]. There are many ways in which this redistribution can operate.

Most of the times, redistribution is presented as a lump-sum transfer to households and firms, or as a reduction in taxes that introduce a deformation into the economy as it is the case of labor taxes. @klenert2018 findings suggest that lump-sum transfers are more stable over time, particularly in countries that are stuck in issues of economic inequality, political distrust and polarization.

In fact, there are no generalities regarding the way the revenues are recycled. Some authors give general lines about which type of redistribution to chose depending on economic and sociopolitical circumstances. An example of that is the diagram tree below, oriented to help decision.

<div>

![](Images/TreeDiagram.JPG "Decision-tree diagram for carbon revenue recycling (Source : @klenert2018 )")

<div>

Fig.4 : Decision-tree diagram for carbon revenue recycling. Source : @klenert2018 .

</div>

</div>

The choice of the type of redistribution has a important role in determining the existence or absence of a double dividend and its importance. However, there are other leverages that are also important, such as the ease with which economic agents can substitute goods, the degree of exposure to foreign competition and the type of representation of the wage equation (the latter has an important role in a Neo-Keynesian framework, which is the case of the ThreeME model).

# Methodology

## ThreeME model

The ThreeME model is a hybrid neo-Keynesian Computable General Equilibrium model (1), which had to be adaptated and calibrated on Tunisian data (2).

### A hybrid neo-Keynesian Computable General Equilibrium model

The [open source](https://github.com/fosem/ThreeME_V3-open) ThreeME model has been developped since 2008 by OFCE (French Economic Observatory), ADEME (French Environment and Energy Management Agency) and NEO (Netherlands Economic Observatory). ThreeME is a Computable General Equilibrium Model (CGEM), with neo-Keynesian features and a hybrid structure.

ThreeME combines several features [@callonnec2013 ; @callonnec2021] :

-   ThreeME is a Computable General Equilibrium Model (CGEM), which takes into account the interactions and feedbacks between supply and demand (see Fig.X). Demand defines supply and in return, supply determines demand through the production factor incomes.

![](Images/Architecture%20of%20a%20CGEM.jpg)

::: {align="center"}
Fig.5 : Architecture of CGEM (source : @callonnec2013)
:::

-   ThreeME is a CGEM of neo-Keynesian inspiration. ThreeME differs from Walrasian CGEM in its dynamics and its transition to the long run. Instead of perfect flexibility hypothesis, prices and quantities slowly adjust, because of uncertainties, adjustment costs or temporal boundaries. Prices do not clear supply and demands and market imperfections are also included in the model. Consequently, there are disequilibrium between supply and demand. For instance, involuntary unemployment is possible.

-   The high sectoral disaggregation is a way to describe the transfers of activity from a sector to another. The ThreeME model allows to track sectoral changes in investment, employment or energy consumption.

-   ThreeME is a hybrid model which combines top-down and bottom-up modelling. On one side, the general equilibrium effets are represented. On the other side, the energy disaggregation allows for the analysis of the energy production and consumption. The trade-offs between energy and other production factors and between several energy consumptions are included in the model.

### ThreeMe model Tunisia : Adaptation for a little country in development

ThreeME has already been adapted to Mexico by @landarivera2016 and to Indonesia by @reynes2017. The adaptation of ThreeME to Tunisia has been founded on consultation with Tunisian experts and other stakeholders. Indeed, the sectoral disaggregation was validated by Tunisian stakeholders. At the end, 21 sectors and 18 products were chosen (see Fig.X). The tax structure is based on the supply and use table (SUT) of the national accounts.

![](Images/Sectoral%20disaggregation.jpg)

::: {align="center"}
Fig.6 : Sectoral disaggregation
:::

The required data are economic data from national accounts, in particular from Input-Output Tables (IOTs), physical data from energy balance and detailed tax data by product. These data were collected from Tunisian institutions, in particular ANME (National Agency for Energy Management), INS (National Institute of statistics), ONE (National Energy Observatory), STEG (Tunisian Company of Electricity and Gas), ITCEQ (Tunisian Institute of Competitiveness and Quantitative Studies), Ministry of Energy, Mines and Energy Transition and the Ministry of Economic Development, Investment and International Cooperation.

## Description of scenarios

We work on six different scenarios that simulate the implementation of six alternative environmental policies. For both policies carbon tax and fossil fuels subsidies removal, there are two scenarios. The first one assuming there is no recycling of revenues and the second one considering some type of recycling of revenues.

-   Scenario 1 : Implementation of a carbon tax from 2021 without redistribution of the revenues of the tax in the economy - they are used to reduce public debt.

-   Scenario 2 : Carbon tax with recycling of revenues that are redirected to the Energy Transition Fund. In fact, a part is given back to households and a portion is devoted to "non-polluting" businesses.

-   Scenario 3 : Fossil fuels subsidies removal (without recycling).

-   Scenario 4 : Fossil fuels subsidies removal (with recycling). A part is given back to households and a portion is given to enterprises in proportion to the employment of each sector in the total salaried labor force.

-   Scenario 5 : Significant penetration of Renewable Energies in the electrical mix (80% by 2050)

-   Scenario 6 : Combination of scenarios 2, 4 and 5.

### Carbon tax evolution

Before 2030, carbon tax level is calculated to cover 100% of the needs of the Energy Transition Fund, and it raises from 1.1 to 9 DT/tCO2 in 10 years. After 2030, the path of the carbon tax is defined in order to achieve the emission reduction objectives for 2050. According to the substitution assumptions retained in ThreeME, achieving an emissions reduction factor of 5 by 2050 (in relation to 2020) requires an increase from 9 DT/tCO2 to 372 DT/tCO2 in the carbon tax. In addition to the carbon tax, price signals have been introduced in order to achieve energy consumption targets by source.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}
ggplot() + 
  geom_line( data = S1, aes(x = year,y = rco2tax_vol.1000, group = 1)) +
    labs(x= "year", y = "Carbon tax rate \n (in constant Tunisian dinars on 2015 per ton of CO2) ", title = "Fig.7 Evolution of carbon tax in Tunisia") +
  scale_x_continuous(breaks=seq(2015,2050,5)) + 
  theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5))

```

### Fossil fuels subsidies removal over time

Changes in fossil fuels subsidies between 2015 and 2020 are due to fluctuations in energy prices, and the data correspond to observations. Then from 2020, the removal of subsidies is implemented gradually until reaching zero subsidies in 2024.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

ggplot() + 
  geom_line( data = S3, aes(x = year,y = abs(esub_gdp_2.gdp_2.1000000..ems_co2_2.1000.), group = 1)) +
    labs(x= "Year", y = "Energy subsidies 
         (in 2015 constant Tunisian dinars per ton of CO2)", title = "Fig.8 Scenarios with lifting of energy subsidies. Energy subsidies.") +
  scale_x_continuous(breaks=seq(2015,2050,5))+ theme(axis.title=element_text(size=9))

# valeur négative passée en valeur absolue 

```

## Choice of evaluation indicators

### Data structure

The analysed data are derived from outputs of model ThreeME Tunisia. All the indicators are simulated from 2015 to 2050, generating a database with time series. The indicators used in the analysis if not exceptionally mentioned are in percentage relative form, meaning the proportional variation to Baseline scenario:

$$ X = \frac{X_{Shock}}{X_{Baseline}} \times 100\% \tag{1}$$ where:

-   $X$ is the indicator used for analysis;
-   $X_{Shock}$ is the model output with different policy scenarios;
-   $X_{Baseline}$ is the model output with baseline scenario;

### Kaya identity

The Kaya identity, firstly proposed by [@kaya1989], is an identity where the total emission of carbon dioxide can be explained by four product driving forces as population, Gross Domestic Product (GDP) per capita, enerny intensity over GDP and carbon intensity over energy consumption [@kayaide2021]. It is expressed in the form:

$$ C = POP \cdot \frac{GDP}{POP} \cdot \frac{TEC}{GDP} \cdot \frac{C}{TEC} \tag{1}$$

where:

-   POP is global population;
-   GDP is gross domestic product;
-   TEC is total energy consumption;
-   C is total emission of carbon dioxide;

And:

-   GDP/POP is GDP per capita describing the economical activities within a period;
-   TEC/GDP is energy intensity;
-   C/TEC is carbon intensity;

In this study, we introduced an extension of Kaya identity to explain how different driving forces influenced the total emission for different scenarios. Firstly, a extended Kaya identity is used to analysis CO~2~ emission with the aggregated factors, then we couple with Logarithmic Mean Divisia Index (LMDI) method to decomposite CO~2~ emission at the sectorial level.

We modified the function of Kaya identity mentioned above to adapt our model assumption, where we integrated a new driving force, named economy structure, to decomposite emissions driving force at sectorial level. The five economic sectors considered in ThreeME Tunisia model are: Industry and Agriculture, Service, Transportation, Energy Transformation and Electricity. However, we did not take population into consideration because its increasing rate remains still over time for all our scenarios and is considered as an exogenous variable in ThreeME model.

Therefore, the CO~2~ emission can be written as:

$$  EM_{tot} = \Sigma EMA_{i} = \Sigma( VA \cdot \frac{VA_{i}}{VA} \cdot \frac{EC_{i}}{VA_{i}} \cdot \frac{CE_{i}}{EC_{i}} )=  \Sigma( V \cdot S_{i} \cdot E_{i} \cdot I_{i}) \tag{2}$$ where EM~tot~ is overall CO~2~ emission, EM~i~ is CO~2~ emission of economic sector i, VA is total added value, VA~i~ is added value of sector i, EC~i~ is total energy consumption by sector i, CE~i~ is CO~2~ emission arising from sector i. According to equation 8, total CO~2~ emission can be explained by four driving forces, including one aggregated indicator, overall economic activities VA, and three sectorial indicators, share of total added value of sector i S~i~, energy intensity over added value of sector i E~i~ and carbon intensity over energy consumption of sector i I~i~. Especially, S~i~ can be interpreted as economy structure of Tunisia, @grubb2015 and @kanitkar2015 found that for a developing country, this term could be a key variable determining the future emissions pathway.

The effects of driving forces can be expressed in two ways: multiplicative and additive form, where multiplicative deviation $D_{tot}$ is the ratio of total CO~2~ emission between policy scenario and baseline scenario (equation 3), and additive deviation $\Delta EM_{tot}$ is the difference of total CO~2~ emission (equation 4). The two expressions are shown below:

$$ D_{tot} =\frac{C_{2}}{C_{0}} = \Pi(\frac{V_{2}}{V_{0}} \cdot \frac{S_{2,i}}{S_{0,i}} \cdot \frac{E_{2,i}}{E_{0,i}}  \cdot \frac{I_{2,i}}{I_{0,i}}) = D_{V}  \cdot  D_{S} \cdot D_{E} \cdot D_{I} = D_{V}  \cdot \Pi ( D_{S_{i}} \cdot D_{E_{i}} \cdot D_{I_{i}}) \tag{3}$$

$$ \Delta EM_{tot} = EM_{2} - EM_{0} = \Delta EM_{VA} + \Delta EM_{S} + \Delta EM_{E} + \Delta EM_{I} = \Delta EM_{V} + \Sigma( \Delta EM_{S_{i}} + \Delta EM_{E_{i}} + \Delta EM_{I_{i}}) \tag{4}$$ where subscript $tot$ represents overall change of emission, subscript 0 and 2 mean baseline scenario and policy scenario respectively. Hence we obtain the index $D_{V}$, $D_{S}$, $D_{E}$ and $D_{I}$, meaning the deviation of emissions due to change of overall economic activities, economy structure, energy intensity and carbon intensity, while $\Delta EM_{V}$, $\Delta EM_{S}$, $\Delta EM_{E}$ and $\Delta EM_{I}$ depict the difference of emissions related to change of driving forces.

Now we expect to identify the effect of each driving force at a sectorial level, to do this, we used a LMDI method proposed by @ang1997 and @ang2005. For multiplicative form, we have:

$$ D_{X} = exp ( \Sigma \frac{(EM_{2,i}-EM_{0,i})/(lnEM_{2,i}-lnEM_{0,i})}{(EM_{2}-EM_{0})/(lnEM_{2}-lnEM_{0})} \cdot ln \frac{X_{2,(i)}}{X_{0,(i)}} ) \tag{11}$$ $$ \Delta EM_{X} =  \Sigma (\frac{EM_{2,i}-EM_{0,i}}{lnEM_{2,i}-lnEM_{0,i}} \cdot ln\frac{X_{2,(i)}}{X_{0,(i)}}) \tag{12} $$ where $EM_{2}$ is total emission of policy scenario, $EM_{0}$ is total emission of baseline, $EM_{2,i}$ is emission of policy scenario arising from sector i, $EM_{0,i}$ is emission of baseline arising from sector i, $D_{X}$ and $\Delta EM_{X}$ represent multiplicative and additive index of driving force $X$, $X_{2,(i)}$ is value of driving force $X$ of policy scenario for sector i, $X_{0,(i)}$ is value of driving force $X$ of baseline for sector i.

It should be noted that we integrated the energy consumption and carbon dioxide emission by household into that of energy transformation sector. On the one hand, household is the aggregation who does not hold added value, but who, at meantime, does contribute to the overall CO2 emissions, however, the emissions arose by households are certainly not negligible. On the other hand, the households consume principally fuels, natural gas and electricity, where the first two are derived from energy transformation sector. As for electricity, the usage of electricity in fact does not arise any emissions according to the assumptions for it is taken into consideration during its generation i.e. electricity sector. This may not be the best solution, however, it does not change our principal results but largely simplify the data treatment process. So we consider, for the following analysis, that for energy transformation sector the consumption of fuels for transportation, fuels for other uses and electricity are derived from households, whilst the natural gas consumption belongs to the sector itself.

# Results and discussions

In this section we will analyse the results obtained for the different scenarios for the different variables taken into account.

## Importance of redistribution

In this section we will analyse the influence of the redistribution of both the carbon tax and the removed energy subsidies. We will observe the impact of the redistribution on both the economical and on the environmental aspect. We will focus on GDP and employment variations among other indicators when it comes to the economical aspect and we will analyse the evolution of CO2 emissions for the environmental aspect.

### Carbon tax with and without redistribution

We first analyse the redistribution of the carbon tax. The figure below shows the variation in GDP in relation to the baseline for both scenarios carbon tax with and without redistribution. We observe that the scenario with redistribution shows a marked increase in GDP since 2030 (+2% in 2050 in relation to the baseline) while GDP decreases for the scenario without redistribution (-1.5% in 2050 in comparison with the baseline). The variations in GDP observed before 2030 are less pronounced, and that correspond to the progressive implementation of the carbon tax.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}
ggplot() + 
  geom_line( data = Sc1, aes(x = year,y = gdp_2, group = 1, color = "Carbon tax without redistribution")) + 
  geom_line( data = Sc2, aes(x = year,y = gdp_2, group = 1, color = "Carbon tax with redistribution")) + 
  labs(y = "GDP variation (%)", title = "Fig.9 GDP in volume. Variation in relation to the baseline") +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

If we analyse employment variations, we can see that the redistribution operates an increase on it in relation to the baseline (+2.3% in 2050). In the scenario without redistribution there is a decrease in the level of employment in comparison with the baseline (-1% in 2050).

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

ggplot() + 
  geom_line( data = Sc1, aes(x = year,y = f_l_2, group = 1, color = "Carbon tax without redistribution")) + 
  geom_line( data = Sc2, aes(x = year,y = f_l_2, group = 1, color = "Carbon tax with redistribution")) + 
  labs(y = "Employment variation (%)", title = "Fig.10 Employment. Variation in relation to the baseline") +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

Regarding CO2 emissions, it is noted that there is not a great difference in the variation between the scenarios carbon tax with and without redistribution. However, we can notice that the reduction in emissions compared to the baseline is slightly larger in the case that there is no redistribution, and this seems consistent with the economic recession observed before.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}
ggplot() + 
  geom_line( data = Sc1, aes(x = year,y = ems_co2_2, group = 1, color = "Carbon tax without redistribution")) + 
  geom_line( data = Sc2, aes(x = year,y = ems_co2_2, group = 1, color = "Carbon tax with redistribution")) + 
  labs(y = "CO2 emissions variation (%)", title = "Fig.11 CO2 emissions. Variation in relation to the baseline") +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

In order to have a deeper comprehension of the effects of tax recycling we will analyse further economic indicators that account for the state of the Tunisian economy. The figures in the two tables below represent the variation in relation to the baseline for each indicator at a given time.

We can initially notice that redistribution tends to increase household consumption. This is intimately related to the type of redistribution chosen. As explained before, a part of the carbon tax revenues is given back to households as lump-sum transfers and this allows consumption to rise (even if moderately) despite the increase on production prices.

Regarding public debt, we notice that it decreases in the two cases despite the presence or absence of redistribution. However, the decrease is much more pronounced in the scenario without redistribution, what seems reasonable since the revenues of the carbon tax are almost exclusively devoted to pay off the public debt.

```{r, echo=FALSE}

tablename <- c("GDP in volume","Household consumption","Investment","Exports","Imports","Household disposable income","Household consumption price index","production price index","Added value price index","Intermediate consumption price index","Export price index","Import price index","Gross nominal wage","Real cost of labor","Wage employment rate (in thousands)","Unemployment rate (in point)","Trade balance (in point of GDP)","Public budget balance (in points of GDP)","Public debt (in points of GDP)", "CO2 emissions")

Table_Macro_CT <- S1_Macro[c("2021","2025","2030","2035","2040","2045","2050"),1:20]
Table_Macro_CT <- t(Table_Macro_CT)
Table_Macro_CT <- round(Table_Macro_CT,digits = 2)
row.names(Table_Macro_CT) <- tablename

kable(Table_Macro_CT, booktabs = T, linesep = "", caption = "Macroeconomic impacts of carbon tax scenario without redistribution in percent deviation to Baseline") %>% 
kable_styling(latex_options = c("striped","hold_position"), full_width = T,font_size = 7) %>% 
row_spec(0, bold = T)  %>% 
column_spec(1, width = "6cm")
```

```{r, echo=FALSE}

tablename <- c("GDP in volume","Household consumption","Investment","Exports","Imports","Household disposable income","Household consumption price index","production price index","Added value price index","Intermediate consumption price index","Export price index","Import price index","Gross nominal wage","Real cost of labor","Wage employment rate (in thousands)","Unemployment rate (in point)","Trade balance (in point of GDP)","Public budget balance (in points of GDP)","Public debt (in points of GDP)", "CO2 emissions")

Table_Macro_CT <- S2_Macro[c("2021","2025","2030","2035","2040","2045","2050"),1:20]
Table_Macro_CT <- t(Table_Macro_CT)
Table_Macro_CT <- round(Table_Macro_CT,digits = 2)
row.names(Table_Macro_CT) <- tablename

kable(Table_Macro_CT, booktabs = T, linesep = "", caption = "Macroeconomic impacts of carbon tax scenario with redistribution in percent deviation to Baseline") %>% 
kable_styling(latex_options = c("striped","hold_position"), full_width = T,font_size = 7) %>% 
row_spec(0, bold = T)  %>% 
column_spec(1, width = "6cm")
```

### Fossil fuels subsidies removal with and without redistribution

If we do the same analyse on the economic indicators for the scenarios subsidies removal with and without redistribution, we notice that in general lines trends are similar.

In the case of GDP variation for the scenario with redistribution, we can see in the figure below that there is a maximum increase of approximately 0.5% around the year 2024 when the subsidies fall to zero. Then there is an stabilization in GDP around baseline levels. For the scenario subsidies removal without redistribution, there is a strong decrease in GDP variation around 2028 (-2.1% in relation to the baseline), and then a progressive increase. However, GDP variation is always negative in comparison to the baseline at least in the period 2020-2050.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}
ggplot() + 
  geom_line( data = Sc3, aes(x = year,y = gdp_2, group = 1, color = "Subsidies removal without redistribution")) + 
  geom_line( data = Sc4, aes(x = year,y = gdp_2, group = 1, color = "Subsidies removal with redistribution")) + 
  labs(y = "GDP variation (%)", title = "Fig.12 GDP in volume. Variation in relation to the baseline") +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

As regards employment, the scenario with redistribution presents a positive variation in relation to the baseline for the period 2020-2030, and then a negative one between 2030 and 2045. This variation is in absolute terms always below 0.5%. If we consider the scenario without redistribution we observe a negative variation that goes beyond -2.5% around 2030.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

ggplot() + 
  geom_line( data = Sc3, aes(x = year,y = f_l_2, group = 1, color = "Subsidies removal without redistribution")) + 
  geom_line( data = Sc4, aes(x = year,y = f_l_2, group = 1, color = "Subsidies removal with redistribution")) + 
  labs(y = "Employment variation (%)", title = "Fig.13 Employment. Variation in relation to the baseline") +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

There are no marked differencies in emissions variation in relation with the baseline between the two scenarios (fossil fuels subsidies removal with and without redistribution). The variation in emissions goes beyond 25% for the scenario without redistribution while it remains below 25% for the scenario with redistribution. As in the case of the carbon tax, the economic recession could explain this difference.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}
ggplot() + 
  geom_line( data = Sc3, aes(x = year,y = ems_co2_2, group = 1, color = "Subsidies removal without redistribution")) + 
  geom_line( data = Sc4, aes(x = year,y = ems_co2_2, group = 1, color = "Subsidies removal with redistribution")) + 
  labs(y = "CO2 emissions variation (%)", title = "Fig.14 CO2 emissions. Variation in relation to the baseline") +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

If we observe the variation in the gross salary, we can notice that in the case of carbon tax there is no difference between the scenarios with or without redistribution for this indicator while for the case of fossil fuels subsidies removal, we can observe that the scenario without redistribution presents a higher variation in relation to the baseline.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

ggplot() + 
  geom_line( data = S1_Macro, aes(x = year,y = Salaire.nominal.brut, group = 1, color = "Carbon tax without redistribution")) + 
  geom_line( data = S2_Macro, aes(x = year,y = Salaire.nominal.brut, group = 1, color = "Carbon tax with redistribution")) + 
  geom_line( data = S3_Macro, aes(x = year,y = Salaire.nominal.brut, group = 1, color = "Subsidies removal without redistribution")) + 
  geom_line( data = S4_Macro, aes(x = year,y = Salaire.nominal.brut, group = 1, color = "Subsidies removal with redistribution")) +
  labs(y = "Gross nominal wage (%)", title = "Fig.15 Gross nominal wage. Variation in relation to the baseline") +
  scale_x_continuous(breaks=seq(2015,2050,5))


```

We will now analyse further indicators for the fossil fuels subsidies removal with and without redistribution scenarios. This indicators give us a more complete panorama of the state of the Tunisian economy.

We observe that the redistribution of the fossil fuels subsidies is at the origin of an augmentation in household consumption, however it is much less pronounced that the augmentation that we observed before for the redistribution of the carbon tax. There is in both cases an improvement in the trade balance, but it is more pronounced in the case without redistribution.

```{r, echo=FALSE}

tablename <- c("GDP in volume","Household consumption","Investment","Exports","Imports","Household disposable income","Household consumption price index","production price index","Added value price index","Intermediate consumption price index","Export price index","Import price index","Gross nominal wage","Real cost of labor","Wage employment rate (in thousands)","Unemployment rate (in point)","Trade balance (in point of GDP)","Public budget balance (in points of GDP)","Public debt (in points of GDP)", "CO2 emissions")

Table_Macro_CT <- S3_Macro[c("2021","2025","2030","2035","2040","2045","2050"),1:20]
Table_Macro_CT <- t(Table_Macro_CT)
Table_Macro_CT <- round(Table_Macro_CT,digits = 2)
row.names(Table_Macro_CT) <- tablename

kable(Table_Macro_CT, booktabs = T, linesep = "", caption = "Macroeconomic impacts of fossil fuels subsidies removal scenario without redistribution in percent deviation to Baseline") %>% 
kable_styling(latex_options = c("striped","hold_position"), full_width = T,font_size = 7) %>% 
row_spec(0, bold = T)  %>% 
column_spec(1, width = "6cm")
```

```{r, echo=FALSE}

tablename <- c("GDP in volume","Household consumption","Investment","Exports","Imports","Household disposable income","Household consumption price index","production price index","Added value price index","Intermediate consumption price index","Export price index","Import price index","Gross nominal wage","Real cost of labor","Wage employment rate (in thousands)","Unemployment rate (in point)","Trade balance (in point of GDP)","Public budget balance (in points of GDP)","Public debt (in points of GDP)", "CO2 emissions")

Table_Macro_CT <- S4_Macro[c("2021","2025","2030","2035","2040","2045","2050"),1:20]
Table_Macro_CT <- t(Table_Macro_CT)
Table_Macro_CT <- round(Table_Macro_CT,digits = 2)
row.names(Table_Macro_CT) <- tablename

kable(Table_Macro_CT, booktabs = T, linesep = "", caption = "Macroeconomic impacts of fossil fuels subsidies removal scenario with redistribution in percent deviation to Baseline") %>% 
kable_styling(latex_options = c("striped","hold_position"), full_width = T,font_size = 7) %>% 
row_spec(0, bold = T)  %>% 
column_spec(1, width = "6cm")
```

After the analyses we made, we can conclude that in general terms scenarios with redistribution produce positive macroeconomic effects in the Tunisian economy. This is the reason why from now on we will only take in consideration the scenarios with redistribution and put aside the scenarios without redistribution.

## Carbon tax

As the carbon tax before 2030 stays at a moderate level, the impacts of this policy are therefore limited, while the significant effects are observed during the later period from 2030 to 2050 when a much stronger tax carbon is implemented. The macroeconomic impacts are summarized in table 1, the results are expressed as percentage deviation from Baseline scenario.

Generally speaking, the policy of carbon tax with redistribution of government revenue has a positive impact on Tunisia's economy. Whereas GDP increases slightly up to 0.13% with respect to baseline on 2030, the relatively rapid augmentation is observed from 2030 to 2050. At the horizon of 2050, it reaches a highest level (+1.93%) thanks to the carbon tax policy. In the meantime, social welfare is improved with the same rhythme as GDP growth, with a higher consumption level (+4.20%) and a higher disposable income (+4.17%) on 2050.

An intuitive influence of carbon tax is that the price of internal market will raise, which is in line with our model output: higher household consumption price of 9.49% with 11.33% and 13.14% for production price and intermediate consumption price, respectively. The increasing cost of household and company will force them to choose the substitution with less CO2 emissions, thus reducing their cost. The variation of internal price also has an impact on the competitiveness of local goods on international market, causing a recession for exportation and a boost for importation.

It is interesting to note that the implemented policy can alleviate social poverty to some extent. We observed, for example, the continuous growth of wage employment. It will then reinforce the acceptability of the climate policy.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

ggplot() + 
  geom_line( aes(x = Det[[2]][,"year"],y = S2[,"ems_ci_co2_2"]/Baseline[,"ems_ci_co2_0"]*100 - 100, group = 1, color = "Total reduction")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"V"], group = 1, color = "Economic activities")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"S"], group = 1, color = "Economy structure")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"E"], group = 1, color = "Energy intensity")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"I"], group = 1, color = "Carbon intensity")) + 
  labs(x = "year", y = "Index LMDI \nin % deviation of emission to Baseline", title = "Fig.16 Multiplicative contribution for overall emissions variation \n Carbon tax with redistribution") +
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

Along with the economical growth, we find that the emissions reduction of 42.2% by 2050 is achieved, then we are now interested in its pathway. To do this, we firstly employ our extended Kaya identity to clarify the main driving forces, where, a priori, Economic activities are expected to have positive effects on emissions, whilst Energy intensity and Carbon intensity should have negative effects. Figure 16 presents the results of all the aggregated driving forces. We observe that economy structure has a significantly positive and growing impact until 2043 where it reaches the peak raising 7947.48 Kt CO2 (+19,38%) with regard to baseline, then it begins to decline to 5650,17 Kt CO2 (+12,46%) on 2050. On the other hand, carbon intensity and energy intensity show the negative and monotone trend, the former reducing 7128.35 Kt CO2 (-13.77%) on 2050 and 30715.93 Kt CO2 (-47.18%) for the later. However, the influence of economic activities is negligible (+886,37 Kt CO2 & +1.86%), revealing that even though the total production remains relatively invariable, the revolution of economy structure and production methods could still strongly impact the emissions pathway.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

ggplot() + 
  geom_line( aes(x = Det[[2]][,"year"],y = S2_Macro[,"Prix.à.la.consommation"], group = 1, color = "Consumption price")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = S2_Macro[,"Prix.à.la.Production"], group = 1, color = "Production price")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = S2_Macro[,"Prix.de.la.valeur.ajoutée"], group = 1, color = "Added value price")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = S2_Macro[,"Prix.des.consommations.intermédiaires"], group = 1, color = "Intermediate consumption price")) + 
  labs(x = "year", y = "Price \n in % deviation to Baseline", title = "Fig.17 Evolution of prices on Tunisia's market \nwith regard to baseline scenario") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

So how do these driving forces work exactly to impact emissions? To answer this question, we conduct a sectorial analysis with the help of our extended Kaya identity. Fig.19 depicts the evolution of economy structure for different sectors. Electricity sector has a positive impact while energy transformation has a negative one, with all other sectors staying relatively stable. It indicates the development of electricity production, and recession of another, standing for the substitution of electricity over fossil fuels. Compared with fossil fuels, electricity is potentially less pollutant because it is the final conversion of renewable energies.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

ggplot() + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"S"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"S_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"S_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"S_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"S_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"S_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI \nin % deviation of emission to Baseline", title = "Fig.18 Multiplicative contribution of economy structure for overall emissions \n Carbon tax with redistribution") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

z <- c(Sc2[,"va_ind_2"],Sc2[,"va_trsp_2"],Sc2[,"va_ser_2"],Sc2[,"va_trsf_2"],Sc2[,"va_ele_2"])
x <- rep(Sc2[,"year"], times = 5)
Legend <- rep(c("Industry & agriculture","Transportation","Services","Energy Transformation","Electricity"), each = 36)

ggplot(
  mapping = aes(
               x = x, 
               y = z, 
               fill = Legend,
               group = 1)
               ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Added value \n in % deviation to Baseline", title = "Fig.19 Revolution of economy structure in Tunisia \nfor Carbon tax with redistribution scenario, \n expressed by added value variation with regard to Baseline scenario") + 
      theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

rm(z,x,Legend)
```

The carbon tax induces the increasing investment for all sectors except energy transformation, firstly to accelerate the penetration of renewable energies in electricity mix and secondly, to reduce the consumption of fossil fuels especially for energy intensive sectors. We observe then the improvement of energy efficiency, in another word reduction of energy intensity, for all the sectors of Tunisia's economy, especially for electricity and industry & agriculture (Fig.x). However, the other sectors display slight reduction of energy intensity. For example, the transportation sector consume majorly jet fuel for aircraft and diesel for container ship. Electrification faces still huge challenges for long distance transportation. The inertia of energy demand thus exists in such a sector despite of the increasing cost for carbon dioxide emission.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

ggplot() + 
  geom_line( aes(x = Sc2[,"year"],y = Sc2[,"ia_ind_2"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Sc2[,"year"],y = Sc2[,"ia_trsp_2"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Sc2[,"year"],y = Sc2[,"ia_ser_2"], group = 1, color = "Services")) + 
  geom_line( aes(x = Sc2[,"year"],y = Sc2[,"ia_trsf_2"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Sc2[,"year"],y = Sc2[,"ia_ele_2"], group = 1, color = "Electricity")) + 
  labs(x = "year", y = "Investment \n in % deviation to Baseline", title = "Fig.20 Investment for different sectors in Tunisia") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}
ggplot() + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"E"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"E_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"E_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"E_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"E_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"E_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI \n in % deviation of emission to Baseline", title = "Fig.21 Multiplicative contribution of energy intensity for overall emissions \n Carbon tax with redistribution") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

Fig. 22 shows how energy consumption varies with the carbon tax, which can be explained by improvement of energy intensity. As what we discussed above, we can find more and more diminished energy demand for all the economic sectors and for household. And one more time, we observe the inertia for transportation and services. Even though there is not noticeable amelioration of energy intensity for energy transformation, the overall shrinkage of the sector explains the energy demand profile.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}
z <- c(S2[,"ci_toe_ind_2"]-Baseline[,"ci_toe_ind_0"],S2[,"ci_toe_trsp_2"]-Baseline[,"ci_toe_trsp_0"],S2[,"ci_toe_ser_2"]-Baseline[,"ci_toe_ser_0"],S2[,"ci_toe_trsf_2"]-Baseline[,"ci_toe_trsf_0"],S2[,"ci_toe_ele_2"]-Baseline[,"ci_toe_ele_0"],S2[,"ch_toe_2"]-Baseline[,"ch_toe_0"])
x <- rep(S2[,"year"], times = 6)
Legend <- rep(c("Industry & agriculture","Transportation","Services","Energy transformation","Electricity","Household"), each = 36)

ggplot(
  mapping = aes(
               x = x, 
               y = z, 
               fill = Legend,
               group = 1)
               ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Energy consumption \n in tep difference to Baseline ", title = "Fig.22 Evolution of energy consumption by different sectors, \nthe difference with respect to Baseline scenario") + 
  theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

rm(z,x,Legend)
```

The energy intensity represents the choice of production technology considering whether it is energy intensive or not, whilst the carbon intensity describes how carbon tax leads the economy to choose the types of energy. We notice a moderate fall for industry & agriculture and energy transformation, meaning the transition towards energies with less emission. The electricity mix is exogenous according to our modelling assumptions, that is why the carbon tax has no effect on it, whereas it might be wildly influenced by climate policies in the real situation. It is worthy to mention here that energy consumption by household are almost from energy transformation sector, so we integrated household energy consumption into energy transformation sector. In fact, the reduction of carbon intensity observed here in energy transformation sector is arose by a different energy mix of household rather than the sector itself.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}
ggplot() + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"I"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"I_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"I_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"I_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"I_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"I_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI \n in % deviation of emission to Baseline", title = "Fig.23 Multiplicative contribution of carbon intensity for overall emissions \n Carbon tax with redistribution") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

As the carbon tax induces the production of green electricity (with less pollution per unit of energy production), the energy consumers then have a more environmental friendly alternative other than fuel. Even though maybe they are not intended to care about the climate change, using this alternative enables them to cut back their costs. Therefore, we see the rapid shifting from fossil fuel to electricity for industry & agriculture and the household, and reaching nearly a half of their energy consumption until 2050 like depicted in Fig. 24 to 27. For industry & agriculture, electricity mainly offsets a part of natural gas demand, which hints the electrification of heating unit for instance. As for household, the wild spread of electrical or hybrid cars reduces the demand for fossil fuel.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}
z_1 <- c(
       S2[,"ci_toe_cfut_ind_2"]/S2[,"ci_toe_ind_2"],
       S2[,"ci_toe_cfuh_ind_2"]/S2[,"ci_toe_ind_2"],
       S2[,"ci_toe_cgas_ind_2"]/S2[,"ci_toe_ind_2"],
       S2[,"ci_toe_cele_ind_2"]/S2[,"ci_toe_ind_2"])
x_1 <- rep(Baseline[,"year"], times = 4)
Legend <- rep(c("Fuels for transportation","Fuels for other use","Natural gas","Electricity"), each = 36)

Fig.1 <-
  ggplot(
  mapping = aes(
                x = x_1, 
                y = z_1, 
                fill = Legend,
                group = 1)
  ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Share of energy consumption", title = "Fig.24 Energy mix of Industry & Agriculture for Carbon tax scenario") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

z_2 <- c(
       Baseline[,"ci_toe_cfut_ind_0"]/Baseline[,"ci_toe_ind_0"],
       Baseline[,"ci_toe_cfuh_ind_0"]/Baseline[,"ci_toe_ind_0"],
       Baseline[,"ci_toe_cgas_ind_0"]/Baseline[,"ci_toe_ind_0"],
       Baseline[,"ci_toe_cele_ind_0"]/Baseline[,"ci_toe_ind_0"])
x_2 <- rep(Baseline[,"year"], times = 4)
Legend <- rep(c("Fuels for transportation","Fuels for other use","Natural gas","Electricity"), each = 36)

Fig.2 <-
  ggplot(
  mapping = aes(
                x = x_2, 
                y = z_2, 
                fill = Legend,
                group = 1)
  ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Share of energy consumption", title = "Fig.25 Energy mix of Industry & Agriculture for Baseline scenario") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))


ggarrange(Fig.1, Fig.2, ncol = 1, common.legend = T, legend = "right")

```

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}
z_1 <- c(
       S2[,"ch_toe_cfut_2"]/S2[,"ch_toe_2"],
       S2[,"ch_toe_cfuh_2"]/S2[,"ch_toe_2"],
       S2[,"ch_toe_cgas_2"]/S2[,"ch_toe_2"],
       S2[,"ch_toe_cele_2"]/S2[,"ch_toe_2"]
        )
x_1 <- rep(Baseline[,"year"], times = 4)
Legend <- rep(c("Fuels for transportation","Fuels for other use","Natural gas","Electricity"), each = 36)

Fig.1 <-
  ggplot(
  mapping = aes(
                x = x_1, 
                y = z_1, 
                fill = Legend,
                group = 1)
  ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Share of energy consumption", title = "Fig.26 Energy mix of household consumption for Carbon tax scenario") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

z_2 <- c(
       Baseline[,"ch_toe_cfut_0"]/Baseline[,"ch_toe_0"],
       Baseline[,"ch_toe_cfuh_0"]/Baseline[,"ch_toe_0"],
       Baseline[,"ch_toe_cgas_0"]/Baseline[,"ch_toe_0"],
       Baseline[,"ch_toe_cele_0"]/Baseline[,"ch_toe_0"]
       )
x_2 <- rep(Baseline[,"year"], times = 4)
Legend <- rep(c("Fuels for transportation","Fuels for other use","Natural gas","Electricity"), each = 36)

Fig.2 <-
  ggplot(
  mapping = aes(
                x = x_2, 
                y = z_2, 
                fill = Legend,
                group = 1)
  ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Share of energy consumption", title = "Fig.27 Energy mix of household consumption for Baseline scenario") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))


ggarrange(Fig.1, Fig.2, ncol = 1, common.legend = T, legend = "right")

```

## Energy subsidies removal

In 2024, there is no more energy subsidy, including for electricity. In contrast to the carbon tax, the long-term effects of a short shock on energy prices can be observed. The energy subsidies removal with redistribution has a positive impact on Tunisian GDP in the short and medium term (+0.56% in 2025 and +0.32%), before entering a phase of diminishing marginal effect (+0.06% in 2040 and -0.03% in 2050). The policy reduces public debt. Thanks to the redistribution, the household disposable income doesn't decrease, but raises. The main macroeconomic impacts of energy subsidies removal with redistribution are discussed in the section "Importance of redistribution".

The removal of energy subsidies has little impact on the split in final consumption between fossil fuels and electricity. The share of electricity remains relatively stable (29% of final consumption in 2050 in the scenario with shock) compared to the Baseline scenario (30% of final consumption in 2050) as shown in figures 28 and 29. Nevertheless, the share between transport fuels, fuels for other uses and gas is modified by the policy. The share of gas and transport fuels (respectively 26% and 29% of final energy consumption) increases compared to the baseline scenario (respectively 24% and 26% of final energy consumption). The share of fuel dedicated to other uses decreases from 21% of final consumption to 16% in the scenario with removal of subsidies.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

tot <- S4[,"ci_toe_ind_2"]+S4[,"ci_toe_trsp_2"]+S4[,"ci_toe_ser_2"]+S4[,"ch_toe_2"]

z_1 <- c(
       (S4[,"ci_toe_cfut_ind_2"]+S4[,"ci_toe_cfut_ser_2"]+S4[,"ci_toe_cfut_trsp_2"]+ S4[,"ch_toe_cfut_2"])/tot,
       (S4[,"ci_toe_cfuh_ind_2"]+S4[,"ci_toe_cfuh_ser_2"]+S4[,"ci_toe_cfuh_trsp_2"]+ S4[,"ch_toe_cfuh_2"])/tot,
      (S4[,"ci_toe_cgas_ind_2"]+S4[,"ci_toe_cgas_ser_2"]+S4[,"ci_toe_cgas_trsp_2"]+ S4[,"ch_toe_cgas_2"])/tot,
       (S4[,"ci_toe_cele_ind_2"]+S4[,"ci_toe_cele_ser_2"]+S4[,"ci_toe_cele_trsp_2"]+ S4[,"ch_toe_cele_2"])/tot)
x_1 <- rep(Baseline[,"year"], times = 4)
Legend <- rep(c("Fuels for transportation","Fuels for other use","Natural gas","Electricity"), each = 36)

Fig.1 <-
  ggplot(
  mapping = aes(
                x = x_1, 
                y = z_1, 
                fill = Legend,
                group = 1)
  ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Share of energy consumption (%)", title = "Fig.28 Energy subsidies scenario with redistribution") + 
    theme(axis.title=element_text(size=7),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))+
scale_y_continuous(labels = scales::percent_format(accuracy = 1))

tot2 <- Baseline[,"ci_toe_ind_0"]+Baseline[,"ci_toe_trsp_0"]+Baseline[,"ci_toe_ser_0"]+Baseline[,"ch_toe_0"]


z_2 <- c(
       (Baseline[,"ci_toe_cfut_ind_0"]+Baseline[,"ci_toe_cfut_ser_0"]+Baseline[,"ci_toe_cfut_trsp_0"]+ Baseline[,"ch_toe_cfut_0"])/tot2,
       (Baseline[,"ci_toe_cfuh_ind_0"]+Baseline[,"ci_toe_cfuh_ser_0"]+Baseline[,"ci_toe_cfuh_trsp_0"]+ Baseline[,"ch_toe_cfuh_0"])/tot2,
      (Baseline[,"ci_toe_cgas_ind_0"]+Baseline[,"ci_toe_cgas_ser_0"]+Baseline[,"ci_toe_cgas_trsp_0"]+ Baseline[,"ch_toe_cgas_0"])/tot2,
       (Baseline[,"ci_toe_cele_ind_0"]+Baseline[,"ci_toe_cele_ser_0"]+Baseline[,"ci_toe_cele_trsp_0"]+ Baseline[,"ch_toe_cele_0"])/tot2)
x_2 <- rep(Baseline[,"year"], times = 4)
Legend <- rep(c("Fuels for transportation","Fuels for other use","Natural gas","Electricity"), each = 36)

Fig.2 <-
  ggplot(
  mapping = aes(
                x = x_2, 
                y = z_2, 
                fill = Legend,
                group = 1)
  ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Share of energy consumption (%)", title = "Fig.29  Baseline scenario") + 
    theme(axis.title=element_text(size=7),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))+
scale_y_continuous(labels = scales::percent_format(accuracy = 1))

figure <- ggarrange(Fig.1, Fig.2, ncol = 1, common.legend = T, legend = "right")

annotate_figure(figure,
               top = text_grob("Share of total final energy consumption by energy", face = "bold", size = 14))

```

CO2 emissions decrease drastically in the short and medium term, before converging to the emission levels of the Baseline scenario. The extension of Kaya identity is used to break down the decline in emissions. Since the electricity mix is exogenous to the ThreeMe model and the part of electricty in total final energy consumption is stable, the carbon intensity does not contribute much to the decrease in emissions as shown in the fig. 30. It is the decrease in energy intensity (-23% in 2025, -27% in 2030 and -12% in 2050 compared to the Baseline scenario) that contributes most to the decrease in emissions. If we break down the contribution of energy intensity to the changes in emissions by sector (Fig. 31), we notice that the energy intensity of the transport sector does not change compared to the baseline scenario. The two sectors with the highest contribution of energy intensity to emission reductions are the electricity sector (-17% in 2025, -18% in 2030 and -9% in 2050 and compared to the Baseline scenario) and the industry and agriculture sector (-6% in 2025, -7% in 2030 and -3% in 2050 compared to the Baseline scenario).

```{r, echo = FALSE, fig.align='center'}


get_legend<-function(myggplot){
  tmp <- ggplot_gtable(ggplot_build(myggplot))
  leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
  legend <- tmp$grobs[[leg]]
  return(legend)
}

plt1 <- ggplot() + 
  geom_line( aes(x = Det[[4]][,"year"],y = S4[,"ems_ci_co2_2"]/Baseline[,"ems_ci_co2_0"]*100 - 100, group = 1, color = "Total reduction")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"V"], group = 1, color = "Economic activities")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"S"], group = 1, color = "Economy structure")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"E"], group = 1, color = "Energy intensity")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"I"], group = 1, color = "Carbon intensity")) + 
  labs(x = "year", y = "Index LMDI in % \n emission deviation to Baseline", title = "Fig.30 Multiplicative contribution \n of all drivers for overall emissions variation") +
    theme(axis.title=element_text(size=6), axis.text=element_text(size=6),legend.text=element_text(size=6),title = element_text(size=7), plot.title = element_text(hjust = 0.5, vjust = 0.5), legend.key.size = unit(0.4, "cm"))+
  scale_x_continuous(breaks=seq(2015,2050,5))



plt2 <- ggplot() + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"E"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"E_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"E_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"E_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"E_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"E_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI in % \n emission deviation to Baseline", title = "Fig.31 Multiplicative contribution of energy intensity \n by sector for overall emissions") + 
    theme(axis.title=element_text(size=6), axis.text=element_text(size=6),legend.text=element_text(size=6),title = element_text(size=7), plot.title = element_text(hjust = 0.5, vjust = 0.5), legend.key.size = unit(0.35, "cm")) +
  scale_x_continuous(breaks=seq(2015,2050,5))

legend0 <- c("Removal")
legend1 <- get_legend(plt1)
legend2 <- get_legend(plt2)
plt1 <- plt1 + theme(legend.position="none")
plt2 <- plt2 + theme(legend.position="none")

grid.arrange(plt1, plt2, legend1, legend2, ncol=2, nrow = 2, heights = c(1.3, 0.6), top = "Kaya identities for energy subsidies removal scenario with redistribution")
```

The decrease in energy intensity is confirmed by the decrease in energy consumption (see Fig. 32). Indeed, households and all sectors see their consumption decrease (-19% for households, -18% for the electricity sector, -16% for the energy transformation sector and -14% for industry and agriculture in 2025 compared to the Baseline scenario). Only the consumption of the transport sector is relatively rigid, which means that in this sector, the potential for energy efficiency improvements or capital use changes is relatively lower.

```{r echo=FALSE, out.width = '70%', out.height = '70%', fig.align='center'}
ggplot() +
geom_line( aes(x = Sc4[,"year"],y = Sc4[,"ci_toe_ind_2"], group = 1, color = "Industry & Agriculture")) + 
    geom_line( aes(x = Sc4[,"year"],y = Sc4[,"ci_toe_trsp_2"], group = 1, color = "Transport")) + 
  geom_line( aes(x = Sc4[,"year"],y = Sc4[,"ci_toe_trsf_2"], group = 1, color = "Energy transformation")) + 
  geom_line( aes(x = Sc4[,"year"],y = Sc4[,"ci_toe_ele_2"], group = 1, color = "Electricity sector")) + 
  geom_line( aes(x = Sc4[,"year"],y = Sc4[,"ch_toe_2"], group = 1, color = "Household")) + 
  labs(x = "Year", y = "Energy consumption (%)", title = "Fig.32 Energy consumption by sector and household consumption") +
    theme(axis.title=element_text(size=9),title = element_text(size=9), axis.text=element_text(size=7), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

We analyse the energy indices for households, as we have data on consumer prices (see Fig. 33). The price of fuels for other use increases by 207% in 2030, but the deviation from the Baseline scenario narrows to +67% in 2050. The decrease in energy consumption seen above is a reaction to rising prices. We use a simple formula for the short-term price elasticity of energy demand $E_{E/P}$. The latter is the ratio of the rate of change in demand and the rate of change in price, with $D_S$ the energy consumption with shock, $D_B$ the energy consumption in the Baseline scenario, $P_S$ the energy price with shock and $D_B$ the energy price in the Baseline scenario. $$ E_{E/P} \, = \,  \frac{\frac{D_S - D_B}{D_B}}{\frac{P_S - P_B}{P_B}} $$

As we saw in the section "Importance of redistribution", the energy subsidies removal has a positive impact on households' disposable income, which is small in the short and medium term. In the long term, households' disposable income increases by 0.68% in 2050 compared to the Baseline scenario. A linear regression confirms the existence of a positive income elasticity, but weak compared to the price elasticity. We therefore neglect the income elasticity of energy demand. The price elasticity of demand is equal to -0.54 in 2021, to -0.33 in 2030 and to -0.44 in 2050. The demand for fuel for other purposes becomes increasingly rigid in the medium term, before becoming relatively more elastic in the long term.

```{r echo=FALSE, out.width = '70%', out.height = '70%', fig.align='center'}
x= (SubvavecRedis[,"pch_cfuh_2"]/SubvavecRedis[,"pch_cfuh_0"]-1)*100
table <- cbind(Sc4[,"year"], Sc4[,"ch_toe_cfuh_2"]/x)
colnames(table) <- c("Year", "Price elasticity")
table <- table[c(7, 11, 16, 21, 26, 31, 36),]
table <- round(table, digits=2)

kable(table, booktabs = T, linesep = "", caption = "Price elasticity of demand for fuel dedicated to other use",)%>%
kable_styling(latex_options = "hold_position", full_width = F,font_size = 7) %>% 
row_spec(0, bold = T)
```

```{r echo=FALSE,out.width = '70%', out.height = '70%', fig.align='center'}
z= (SubvavecRedis[,"pch_cfut_2"]/SubvavecRedis[,"pch_cfut_0"]-1)*100
x= (SubvavecRedis[,"pch_cfuh_2"]/SubvavecRedis[,"pch_cfuh_0"]-1)*100
w= (SubvavecRedis[,"pch_cgas_2"]/SubvavecRedis[,"pch_cgas_0"]-1)*100
e= (SubvavecRedis[,"pch_cele_2"]/SubvavecRedis[,"pch_cele_0"]-1)*100



Fig.1 <- ggplot() + 
  geom_line( aes(x = Sc4[,"year"],y = z, group = 1, color = "Fuels for transportation")) + 
  geom_line( aes(x = Sc4[,"year"],y = x, group = 1, color = "Fuels for other use")) + 
  geom_line( aes(x = Sc4[,"year"],y = w, group = 1, color = "Natural gas")) + 
  geom_line( aes(x = Sc4[,"year"],y = e, group = 1, color = "Electricity")) + 
  labs(x = "Year", y = "Price (%)", title = "Fig.33 Household energy prices") +
    theme(axis.title=element_text(size=9),axis.text=element_text(size=6), title = element_text(size=8), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))





Fig.2 <- ggplot() + 
  geom_line( aes(x = Sc4[,"year"],y = Sc4[,"ch_toe_cfut_2"], group = 1, color = "Fuels for transportation")) + 
    geom_line( aes(x = Sc4[,"year"],y = Sc4[,"ch_toe_cfuh_2"], group = 1, color = "Fuels for other use")) + 
  geom_line( aes(x = Sc4[,"year"],y = Sc4[,"ch_toe_cgas_2"], group = 1, color = "Natural gas")) + 
  geom_line( aes(x = Sc4[,"year"],y = Sc4[,"ch_toe_cele_2"], group = 1, color = "Electricity")) + 
  labs(x = "Year", y = "Price (%)", title = "Fig.34 Household energy consumption") +
    theme(axis.title=element_text(size=9),title = element_text(size=8), axis.text=element_text(size=6), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))


figure <- ggarrange(Fig.1, Fig.2, nrow = 1, common.legend = T, legend = "bottom")

annotate_figure(figure,
               top = text_grob("Evolution of energy indices in deviation from Baseline (%)", face = "bold", size = 14))
```

In the short and medium term, rising energy prices lead to a relative decrease in energy intensity and in the price elasticity of energy demand. On the one hand, some of this decrease corresponds to the capital use adjustment channel [@finn2000 ; @gamtessa2018a]. Companies respond to high energy costs by selecting the most energy-efficient capital available, resulting in reduced energy consumption and underutilisation of capital. On the other hand, in the long run, some of the decrease in energy intensity corresponds to additional investment and energy efficiency improvement. This reaction implies an increase in capital productivity. Indeed, investment in industry and agriculture is always higher than in the baseline scenario (+6.6% in 2050, see fig. 35). In the long run, the interaction between these different channels leads to a convergence of post-shock energy consumption towards the levels of the Baseline scenario. This long-term increase in energy consumption is explained either by the readjustment of capital use or by a direct rebound effect.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}


BROWN <- "#AD8C97"
BROWN_DARKER <- "#7d3a46"
GREEN <- "#2FC1D3"
BLUE <- "#076FA1"
GREY <- "#C7C9CB"
GREY_DARKER <- "#5C5B5D"
RED <- "#E3120B"


Sectors <- c("Industry and agriculture","Transports","Services","Energy transformation","Electricity")

stacked_data <- data.frame(
  year = rep(S6[,"year"], times = 5),
  percent = c(Sc4[,"ia_ind_2"],Sc4[,"ia_trsp_2"],Sc4[,"ia_ser_2"],Sc4[,"ia_trsf_2"],Sc4[,"ia_ele_2"]),
  Sectors = factor(rep(Sectors, each = 36), levels = rev(Sectors))
)



plt2 <- ggplot(stacked_data) +
  # color = "white" indicates the color of the lines between the areas
  geom_area(aes(year, percent, fill = fct_reorder(Sectors, abs(percent),.desc = TRUE)), position = 'identity', color = "white") +
  scale_fill_manual(values = c(GREY, BROWN, GREEN, BLUE, BROWN_DARKER))+
  labs(x = "year", y = "Investment (in %)", title = "Fig.35 Change in investment by sector \nin deviation from the baseline scenario. \nEnergy subsidy removal scenario with redistribution.") + 
      theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))+
guides(fill=guide_legend(title="Sectors"))

plt2

```

## Renewable energy scenario

In this section, we are interested in the impacts of renewable energy penetration into electricity mix. The main macroeconomic indicators are presented in the table below. Differently from carbon tax and energy subsidies, the penetration of renewable energy does not perturb prices in the market. The increasing GPD ( +2.96% on 2050 with respect to baseline ) is mainly derived from prosperity of electricity generation sector, where the relative variation to baseline scenario is up to +478.7% by the horizon 2050. The rapid development of electricity sector brings also the abundance of working opportunities ( +103k on 2050 with respect to baseline ), arising then the household disposable income to 3.47% compared with null policy scenario. In fact, the electricity is the only sector which is significantly touched by this policy in terms of either economy or energy (Fig.x and x). As there is no other economic levers to incite energetic transition, the boom of economy can be understood as the growing productivity with much less energetic constrains.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

tablename <- c("GDP in volume","Household consumption","Investment","Exports","Imports","Household disposable income","Household consumption price index","production price index","Added value price index","Intermediate consumption price index","Export price index","Import price index","Gross nominal wage","Real cost of labor","Wage employment rate (in thousands)","Unemployment rate (in point)","Trade balance (in point of GDP)","Public budget balance (in points of GDP)","Public debt (in points of GDP)", "CO2 emissions")

Table_Macro_ENR <- S5_Macro[c("2021","2025","2030","2035","2040","2045","2050"),1:20]
Table_Macro_ENR <- t(Table_Macro_ENR)
Table_Macro_ENR <- round(Table_Macro_ENR,digits = 2)
row.names(Table_Macro_ENR) <- tablename

kable(Table_Macro_ENR, booktabs = T, linesep = "", caption = "Macroeconomic impacts of Renewable energy scenario in percent deviation to Baseline") %>% 
kable_styling(latex_options = "hold_position", full_width = T,font_size = 7) %>% 
row_spec(0, bold = T)  %>% 
column_spec(1, width = "6cm")
```

When it comes to the environmental sphere ( seeing Fig.x ), electricity sector is the only one with negative impact on emissions profile, it compensates the positive impacts arose from all other sectors, resulting in a emissions reduction up to 29.24% by the end of 2050. Fig.x depicts the evolution of different driving forces to emissions, where we find such a emissions reduction is totally thanks to the amelioration of energy intensity while economic structure and carbon intensity contribute in another way to CO2 emissions.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

ggplot() + 
  geom_line( aes(x = Det[[5]][,"year"],y = (S5[,"ems_co2_2"]/Baseline[,"ems_co2_0"] - 1)*100, group = 1, color = "Total reduction")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"V"], group = 1, color = "Economic activities")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"trsf"], group = 1, color = "Energy Transformation")) +
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"ele"], group = 1, color = "Electricity")) + 
  labs(x = "year", y = "Index LMDI \nin % deviation of emission to Baseline", title = "Fig.36 Multiplicative contribution for overall emissions variation \n by different sectors for Renewable Energy scenario") +
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

ggplot() + 
  geom_line( aes(x = Det[[5]][,"year"],y = S5[,"ems_co2_2"]/Baseline[,"ems_co2_0"]*100 - 100, group = 1, color = "Total reduction")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"V"], group = 1, color = "Economic activities")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"S"], group = 1, color = "Economy structure")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"E"], group = 1, color = "Energy intensity")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"I"], group = 1, color = "Carbon intensity")) + 
  labs(x = "year", y = "Index LMDI \nin % deviation of emission to Baseline", title = "Fig.37 Multiplicative contribution for overall emissions variation \n Renewable Energy") +
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

The renewable energies policy prompts the rapid development of electricity sector, but at the same time constrains that of energy transformation sector as shown in the Fig.x. Such a policy will give rise to a supply-side structural revolution of energy sector in Tunisia. More and more investment will be incited into green energy exploitation, then reduce the cost to exploit renewable energies, making it increasingly profitable and engendering a growing share of green electricity in the grid. On the other hand, the fossil fuels lose its competitiveness compared to renewable electricity due to the shrinkage of innovation (seeing Fig.x).

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

ggplot() + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"S"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"S_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"S_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"S_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"S_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"S_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI \nin % deviation of emission to Baseline", title = "Fig.38 Multiplicative contribution of economy structure \n  for overall emissions variation of Renewable Energy scenario") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

ggplot() + 
  geom_line( aes(x = Sc5[,"year"],y = Sc5[,"ia_ind_2"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Sc5[,"year"],y = Sc5[,"ia_trsp_2"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Sc5[,"year"],y = Sc5[,"ia_ser_2"], group = 1, color = "Services")) + 
  geom_line( aes(x = Sc5[,"year"],y = Sc5[,"ia_trsf_2"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Sc5[,"year"],y = Sc5[,"ia_ele_2"], group = 1, color = "Electricity")) + 
  labs(x = "year", y = "Investment \n in % deviation to Baseline", title = "Fig.39 Investment for different sectors in Tunisia") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

In fact, the expanding investment not only cuts back the cost of exploitation, but also boosts the energy efficiency in electricity sector. We notice from Fig.x that electricity is the only sector where there is a reduction of energy intensity. This is quite intuitive for the emerging renewable energies replace the fossil fuels in electricity mix, meaning a stronger independence to fossil fuels, thus less emissions during electricity generation.

As discussed above that the electricity is the only sector who is impacted by this policy, the penetration of renewable energies could seldom influence other sectors. We observe then a rebound effect for certain sectors. Apparently the renewable energy does not induce the innovation oriented to improve energy efficiency, and on the other hand, the fact knowing that electricity is a much more environmental friendly energy, makes them somehow indifferent to consume more or less energies. That is to say, the penetration just provides an alternative with less environmental impacts, rather than intrinsically resolves the problem meaning a transition from energy-intensive to energy-efficient production. Thus, in terms of sustainable development, the renewable energies policy should better cooperate with other economic levers in order to guarantee its efficiency in the longer term.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}
ggplot() + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"E"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"E_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"E_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"E_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"E_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"E_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI \n in % deviation of emission to Baseline", title = "Fig.40 Multiplicative contribution of energy intensity  \n for overall emissions variation of Renewable Energy senario") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

## National Low-Carbon Strategy scenario

The National Low-Carbon strategy is a mix of previous policies: carbon tax with redistribution, energy subsidies removal with redistribution and development of renewable energy. As shown in the table X, the impact of the policy is positive on GDP (+4.5% in 2050) and strongly negative on CO2 emissions (-66% in 2050) compared to the Baseline scenario. The policy mix makes it possible to combine the "explosive" nature of the energy subsidies removal and the renewable energy scenario with the gradual rise of the carbon tax (see fig. 41 to 44). In 2025, the increase in GDP compared to the Baseline scenario is +1.07% against +0.1% for the scenario with carbon tax, +0.56% for the scenario with removal of subsidies and +0.5% for the scenario with renewable energy. In the short term, the effect of the policy mix is additive for the GDP. In 2050, the increase in GDP compared to the Baseline scenario is +4.42% compared to +1.93% for the scenario with carbon tax, -0.02% for the scenario with removal of subsidies and +2.96% for the scenario with renewable energy. In the long run, the effect of the policy mix is less than additive.

```{r, echo=FALSE}

tablename <- c("GDP in volume","Household consumption","Investment","Exports","Imports","Household disposable income","Household consumption price index","production price index","Added value price index","Intermediate consumption price index","Export price index","Import price index","Gross nominal wage","Real cost of labor","Wage employment rate (in thousands)","Unemployment rate (in point)","Trade balance (in point of GDP)","Public budget balance (in points of GDP)","Public debt (in points of GDP)", "CO2 emissions")

Table_Macro_SNBC <- S6_Macro[c("2021","2025","2030","2035","2040","2045","2050"),1:20]
Table_Macro_SNBC <- t(Table_Macro_SNBC)
Table_Macro_ENR <- round(Table_Macro_SNBC,digits = 2)
row.names(Table_Macro_SNBC) <- tablename


Table_Macro_SNBC <- Table_Macro_SNBC[-c(8:13,15 ),]
Table_Macro_SNBC <- round(Table_Macro_SNBC, digits=2)

kable(Table_Macro_SNBC, booktabs = T, linesep = "", caption = "Macroeconomic impacts of Nation Low-Carbon Strategy scenario in percent deviation to Baseline") %>% 
kable_styling(latex_options = "hold_position", full_width = T,font_size = 7) %>% 
row_spec(0, bold = T)  %>% 
column_spec(1, width = "6cm")
```

```{r,echo = FALSE, fig.align='center'}
get_legend<-function(myggplot){
  tmp <- ggplot_gtable(ggplot_build(myggplot))
  leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
  legend <- tmp$grobs[[leg]]
  return(legend)
}

plot1 <- ggplot() + 
  geom_line( aes(x = Sc6[,"year"],y = S6_Macro[,"PIB"], group = 1, color = "National Low Cabron strategy"), size=1.5) + 
  geom_line( aes(x = Sc4[,"year"],y = S2_Macro[,"PIB"], group = 1, color = "Carbon tax with redistribution")) + 
 geom_line( aes(x = Sc4[,"year"],y = S4_Macro[,"PIB"], group = 1, color = "Energy subsidies removal with redistribution")) + 
    geom_line( aes(x = Sc4[,"year"],y = S5_Macro[,"PIB"], group = 1, color = "Renewable energy")) +
  labs(x = "Year", y = " GDP (%)", title = "Fig.41 GDP") + 
    theme(axis.text=element_text(size=6),legend.text=element_text(size=7),axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

plot2 <- ggplot() + 
  geom_line( aes(x = Sc6[,"year"],y = S6_Macro[,"Taux.de.chômage"], group = 1, color = "SNBC"), size=1.5) + 
  geom_line( aes(x = Sc4[,"year"],y = S2_Macro[,"Taux.de.chômage"], group = 1, color = "Taxe carbone")) + 
 geom_line( aes(x = Sc4[,"year"],y = S4_Macro[,"Taux.de.chômage"], group = 1, color = "Levée de \nsubventions")) + 
    geom_line( aes(x = Sc4[,"year"],y = S5_Macro[,"Taux.de.chômage"], group = 1, color = "ENR")) +
  labs(x = "Year", y = "Rate of unemployment (%)", title = "Fig.42  Rate of unemployment") + 
    theme(axis.title=element_text(size=9),axis.text=element_text(size=6),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

plot3 <- ggplot() + 
  geom_line( aes(x = Sc6[,"year"],y = S6_Macro[,"Investissement"], group = 1, color = "SNBC"), size=1.5) + 
  geom_line( aes(x = Sc4[,"year"],y = S2_Macro[,"Investissement"], group = 1, color = "Taxe carbone")) + 
 geom_line( aes(x = Sc4[,"year"],y = S4_Macro[,"Investissement"], group = 1, color = "Levée de \nsubventions")) + 
    geom_line( aes(x = Sc4[,"year"],y = S5_Macro[,"Investissement"], group = 1, color = "ENR")) +
  labs(x = "Year", y = "Investment (%)", title = "Fig.43 Investment") + 
    theme(axis.title=element_text(size=9),axis.text=element_text(size=6), title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))


plot4 <- ggplot() + 
  geom_line( aes(x = Sc4[,"year"],y = S6_Macro[,"Emissions.CO2"], group = 1, color = "SNBC"), size=1.5) + 
  geom_line( aes(x = Sc4[,"year"],y = S2_Macro[,"Emissions.CO2"], group = 1, color = "Taxe carbone avec redistribution")) + 
    geom_line( aes(x = Sc4[,"year"],y = S5_Macro[,"Emissions.CO2"], group = 1, color = "ENR")) + 
      geom_line( aes(x = Sc4[,"year"],y = S4_Macro[,"Emissions.CO2"], group = 1, color = "Levée des subventions \nénergétiques avec redistribution")) + 
  labs(x = "Année", y = " Co2 (%)", title = "Fig.44 CO2 Emissions (%)") + 
    theme(axis.title=element_text(size=9),axis.text=element_text(size=6),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

legend <- get_legend(plot1)
plot1 <- plot1 + theme(legend.position="none")
plot2 <- plot2 + theme(legend.position="none")
plot3 <- plot3 + theme(legend.position="none")
plot4 <- plot4 + theme(legend.position="none")

figure <- ggarrange(plot1, plot2, plot3, plot4, legend)
annotate_figure(figure, top = text_grob("Impacts by scenario in deviation to Baseline scenario (%)", face = "bold", size = 14))
```

Figure 45 shows us the extended Kaya decomposition. The energy intensity drops by 85% in 2050 compared to the baseline scenario. As shown in Figure 46, the electricity sector contributes most to this decrease. The combined effect of the carbon tax, the removal of subsidies and the development of renewable energies has a strong impact on energy use in the electricity sector.

```{r, echo = FALSE}


get_legend<-function(myggplot){
  tmp <- ggplot_gtable(ggplot_build(myggplot))
  leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
  legend <- tmp$grobs[[leg]]
  return(legend)
}

plt1 <- ggplot() + 
  geom_line( aes(x = Det[[6]][,"year"],y = S4[,"ems_ci_co2_2"]/Baseline[,"ems_ci_co2_0"]*100 - 100, group = 1, color = "Total reduction")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"V"], group = 1, color = "Economic activities")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"S"], group = 1, color = "Economy structure")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"E"], group = 1, color = "Energy intensity")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"I"], group = 1, color = "Carbon intensity")) + 
  labs(x = "year", y = "Index LMDI in % \n emission deviation to Baseline", title = "Fig.45 Multiplicative contribution \n of all drivers for overall emissions variation") +
    theme(axis.title=element_text(size=6), axis.text=element_text(size=6),legend.text=element_text(size=6),title = element_text(size=7), plot.title = element_text(hjust = 0.5, vjust = 0.5), legend.key.size = unit(0.4, "cm"))+
  scale_x_continuous(breaks=seq(2015,2050,5))



plt2 <- ggplot() + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"E"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"E_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"E_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"E_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"E_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"E_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI in % \n emission deviation to Baseline", title = "Fig.46 Multiplicative contribution of energy intensity \n by sector for overall emissions") + 
    theme(axis.title=element_text(size=6), axis.text=element_text(size=6),legend.text=element_text(size=6),title = element_text(size=7), plot.title = element_text(hjust = 0.5, vjust = 0.5), legend.key.size = unit(0.35, "cm")) +
  scale_x_continuous(breaks=seq(2015,2050,5))

legend0 <- c("Removal")
legend1 <- get_legend(plt1)
legend2 <- get_legend(plt2)
plt1 <- plt1 + theme(legend.position="none")
plt2 <- plt2 + theme(legend.position="none")

figure <- ggarrange(plt1, plt2, legend1, legend2, ncol=2, nrow = 2, heights = c(1.3, 0.6))
annotate_figure(figure,
               top = text_grob("Kaya identities for National Low Carbon strategy (%)", face = "bold", size = 14))
```

The decrease in energy intensity in the electricity sector, via the investment channel, corresponds to a strong improvement in energy efficiency.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}


BROWN <- "#AD8C97"
BROWN_DARKER <- "#7d3a46"
GREEN <- "#2FC1D3"
BLUE <- "#076FA1"
GREY <- "#C7C9CB"
GREY_DARKER <- "#5C5B5D"
RED <- "#E3120B"


Sectors <- c("Industry and agriculture","Transports","Services","Energy transformation","Electricity")

stacked_data <- data.frame(
  year = rep(S6[,"year"], times = 5),
  percent = c(Sc6[,"ia_ind_2"],Sc6[,"ia_trsp_2"],Sc6[,"ia_ser_2"],Sc6[,"ia_trsf_2"],Sc6[,"ia_ele_2"]),
  Sectors = factor(rep(Sectors, each = 36), levels = rev(Sectors))
)



plt2 <- ggplot(stacked_data) +
  # color = "white" indicates the color of the lines between the areas
  geom_area(aes(year, percent, fill = fct_reorder(Sectors, abs(percent),.desc = TRUE)), position = 'identity', color = "white") +
  scale_fill_manual(values = c(GREY, BROWN, GREEN, BLUE, BROWN_DARKER))+
  labs(x = "year", y = "Investment (in %)", title = "Fig.47 Change in investment by sector \nin deviation from the baseline scenario. \nNational Low Carbon strategy") + 
      theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))+
guides(fill=guide_legend(title="Sectors"))

plt2

```

The national low carbon strategy creates winners and losers. The electricity sector is a major beneficiary of the policy mix, while the energy transformation sector experiences a sharp decline in its value added (see figure 48).

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

BROWN <- "#AD8C97"
BROWN_DARKER <- "#7d3a46"
GREEN <- "#2FC1D3"
BLUE <- "#076FA1"
GREY <- "#C7C9CB"
GREY_DARKER <- "#5C5B5D"
RED <- "#E3120B"
  
  
  Sectors <- c("Industry & agriculture","Transportation","Services","Energy Transformation","Electricity")

stacked_data <- data.frame(
  year = rep(S6[,"year"], times = 5),
  percent = c(Sc6[,"va_ind_2"],Sc6[,"va_trsp_2"],Sc6[,"va_ser_2"],Sc6[,"va_trsf_2"],Sc6[,"va_ele_2"]),
  Sectors = factor(rep(Sectors, each = 36), levels = rev(Sectors))
)


plt1 <- ggplot(stacked_data) +
  # color = "white" indicates the color of the lines between the areas
  geom_area(aes(year, percent, fill = fct_reorder(Sectors, abs(percent),.desc = TRUE)), position = 'identity', color = "white") +
  scale_fill_manual(values = c(BROWN, GREEN, BLUE, BROWN_DARKER, RED))+
  labs(x = "year", y = "Added value \n variation in % to Baseline", title = "Fig.48 Added value variation with regard to Baseline scenario") + 
      theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))+
  guides(fill=guide_legend(title="Sectors"))
plt1
```

Figure 49 shows that electricity increases from 19% of final energy consumption in Tunisia in 2050 to 30% in 2050.

```{r, echo = FALSE, out.width = '70%', out.height = '70%', fig.align='center'}

tot <- S6[,"ci_toe_ind_2"]+S6[,"ci_toe_trsp_2"]+S6[,"ci_toe_ser_2"]+S6[,"ch_toe_2"]

z_1 <- c(
       (S6[,"ci_toe_cfut_ind_2"]+S6[,"ci_toe_cfut_ser_2"]+S6[,"ci_toe_cfut_trsp_2"]+ S6[,"ch_toe_cfut_2"])/tot,
       (S6[,"ci_toe_cfuh_ind_2"]+S6[,"ci_toe_cfuh_ser_2"]+S6[,"ci_toe_cfuh_trsp_2"]+ S6[,"ch_toe_cfuh_2"])/tot,
      (S6[,"ci_toe_cgas_ind_2"]+S6[,"ci_toe_cgas_ser_2"]+S6[,"ci_toe_cgas_trsp_2"]+ S6[,"ch_toe_cgas_2"])/tot,
       (S6[,"ci_toe_cele_ind_2"]+S6[,"ci_toe_cele_ser_2"]+S6[,"ci_toe_cele_trsp_2"]+ S6[,"ch_toe_cele_2"])/tot)
x_1 <- rep(Baseline[,"year"], times = 4)
Legend <- rep(c("Fuels for transportation","Fuels for other use","Natural gas","Electricity"), each = 36)

Fig.1 <-
  ggplot(
  mapping = aes(
                x = x_1, 
                y = z_1, 
                fill = Legend,
                group = 1)
  ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Share of energy consumption (%)", title = "Fig.49 National Low Carbon strategy") + 
    theme(axis.title=element_text(size=7),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))+
scale_y_continuous(labels = scales::percent_format(accuracy = 1))

tot2 <- Baseline[,"ci_toe_ind_0"]+Baseline[,"ci_toe_trsp_0"]+Baseline[,"ci_toe_ser_0"]+Baseline[,"ch_toe_0"]


z_2 <- c(
       (Baseline[,"ci_toe_cfut_ind_0"]+Baseline[,"ci_toe_cfut_ser_0"]+Baseline[,"ci_toe_cfut_trsp_0"]+ Baseline[,"ch_toe_cfut_0"])/tot2,
       (Baseline[,"ci_toe_cfuh_ind_0"]+Baseline[,"ci_toe_cfuh_ser_0"]+Baseline[,"ci_toe_cfuh_trsp_0"]+ Baseline[,"ch_toe_cfuh_0"])/tot2,
      (Baseline[,"ci_toe_cgas_ind_0"]+Baseline[,"ci_toe_cgas_ser_0"]+Baseline[,"ci_toe_cgas_trsp_0"]+ Baseline[,"ch_toe_cgas_0"])/tot2,
       (Baseline[,"ci_toe_cele_ind_0"]+Baseline[,"ci_toe_cele_ser_0"]+Baseline[,"ci_toe_cele_trsp_0"]+ Baseline[,"ch_toe_cele_0"])/tot2)
x_2 <- rep(Baseline[,"year"], times = 4)
Legend <- rep(c("Fuels for transportation","Fuels for other use","Natural gas","Electricity"), each = 36)

Fig.2 <-
  ggplot(
  mapping = aes(
                x = x_2, 
                y = z_2, 
                fill = Legend,
                group = 1)
  ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Share of energy consumption (%)", title = "Fig.50  Baseline scenario") + 
    theme(axis.title=element_text(size=7),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))+
scale_y_continuous(labels = scales::percent_format(accuracy = 1))

figure <- ggarrange(Fig.1, Fig.2, ncol = 1, common.legend = T, legend = "right")

annotate_figure(figure,
               top = text_grob("Share of total final energy consumption by energy", face = "bold", size = 14))

```

# Conclusion

When working with an Integrated Assessment Model as is the case of ThreeME we should pay attention not to attach too much importance to precise figures but instead to keep the whole in perspective, to focus on trends rather than on specific values. Another thing to keep in mind is that the model works on the basis of several hypothesis that influence the results in one way or another.

Taking these remarks into consideration, we will try to draw some conclusions from the data analysis that we have made. First, it can be deduced that the SNBC scenario is the one that is preferred since the mix of policies appears to have the most positive macroeconomic effects. Second, the redistribution of the revenues that come from the carbon tax and the fossil fuels subsidies removal does have a positive impact on the economy and on the environmental and a double dividend is observed.

Maybe one of the strongest hypothesis of the model is that it is a Neo-Keynesian one. This imply that prices and quantities do not adjust instantaneously but instead, they adjust slowly. Unlike Walrasian's models, Neo-Keynesian's models do not assume full utilization of production factors then giving rise to unemployment and to spare production capacities. The slow adjustments between capital and labor lead to a long term optimal relation between the level of production factors and the level of production, and this promote a positive multiplier effect of an increase in public spending (OFCE). The eviction effect is then limited and the double dividend is favored.

There is another point that should be highlighted, this time about the statistical framework. The data concerning the Tunisian economy comes from the system of national accounts and then the informal sectors of the economy are not taken into account. This can distort results since informal sectors are important in many African countries.

Last but not least, social and political acceptability of environmental policies are not taken into account in the model.

# Bibliography
