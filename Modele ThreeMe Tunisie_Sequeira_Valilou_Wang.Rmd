---
title: "Model ThreeMe Tunisia"
author: "Lucia SEQUEIRA - Bijan VALILOU - Jin WANG"
date: "January 2022"
output:
  pdf_document: 
    citation_package: biblatex
    toc: yes
    number_sections: yes
    toc_depth: 4
    highlight: tango
    latex_engine: lualatex
    fig_caption: yes
  html_document: 
    toc: yes
    toc_depth: 5
subtitle: 'Macroeconomic impacts of National Low-Carbon Strategy for a little country in development : the case of Tunisia'
header-includes:
- \usepackage{fancyhdr}
- \pagestyle{fancy}
- \fancyfoot[CO,CE]{Modèle ThreeMe Tunisie}
- \fancyfoot[LE,RO]{\thepage}
bibliography: references.bib
---

```{r, echo = FALSE, tidy = TRUE, include = FALSE}

# Importer des packages
library(knitr) 
library(rmarkdown) 
library(markdown) 
library(readxl)
library(tibble)
library(ggplot2)
library(dplyr)
library(usethis)
library(kableExtra)
library(ggpubr)
```

```{r, echo = FALSE, tidy = TRUE, include = FALSE}

# Importer de la base de données
sheet_names <- excel_sheets("Page Reporting_shock des scénarios.xlsx")
nb_sheets <- length(sheet_names)
for (i in 1:nb_sheets){  
        name <- sheet_names[i] 
        name2 <- paste0(name) 
        data <- read_excel("Page Reporting_shock des scénarios.xlsx", sheet = i) 
        data <- column_to_rownames(data, var = '_date_')
        colnames(data) <- c(2015:2050)
        data <- data.frame(t(data))
        data$year <- c(2015:2050)
        assign(name2,data)
        rm(name,name2,data)
} 

Sc1 <- (S1/Baseline-1)*100
Sc2 <- (S2/Baseline-1)*100
Sc3 <- (S3/Baseline-1)*100
Sc4 <- (S4/Baseline-1)*100
Sc5 <- (S5/Baseline-1)*100
Sc6 <- (S6/Baseline-1)*100
Sc1$year <- c(2015:2050)
Sc2$year <- c(2015:2050)
Sc3$year <- c(2015:2050)
Sc4$year <- c(2015:2050)
Sc5$year <- c(2015:2050)
Sc6$year <- c(2015:2050)

sheet_names <- excel_sheets("Page Macro.xlsx")
nb_sheets <- length(sheet_names)
for (i in 1:nb_sheets){  
        name <- sheet_names[i] 
        name2 <- paste0(name,"_Macro") 
        data <- read_excel("Page Macro.xlsx", sheet = i) 
        data <- column_to_rownames(data, var = '_date_')
        colnames(data) <- c(2015:2050)
        data <- data.frame(t(data))
        data$year <- c(2015:2050)
        assign(name2,data)
        rm(name,name2,data)
} 
```

```{r, echo=FALSE, tidy = TRUE, include = FALSE}

sc <- c("KAYA_1","KAYA_2","KAYA_3","KAYA_4","KAYA_5","KAYA_6")
kayaname <- c("S_ind","S_trsp","S_ser","S_trsf","S_ele","E_ind","E_trsp","E_ser","E_trsf","E_ele","I_ind","I_trsp","I_ser","I_trsf","I_ele","V")
va <- c("va_ind_2","va_trsp_2","va_ser_2","va_trsf_2","va_ele_2","ci_toe_ind_2","ci_toe_trsp_2","ci_toe_ser_2","ci_toe_trsf_2","ci_toe_ele_2","ems_ci_co2_ind_2","ems_ci_co2_trsp_2","ems_ci_co2_ser_2","ems_ci_co2_trsf_2","ems_ci_co2_ele_2","year","va_2")
va_0 <- c("va_ind_0","va_trsp_0","va_ser_0","va_trsf_0","va_ele_0","ci_toe_ind_0","ci_toe_trsp_0","ci_toe_ser_0","ci_toe_trsf_0","ci_toe_ele_0","ems_ci_co2_ind_0","ems_ci_co2_trsp_0","ems_ci_co2_ser_0","ems_ci_co2_trsf_0","ems_ci_co2_ele_0","year","va_0")


DataBase <- list(S1,S2,S3,S4,S5,S6)

for (i in 1:6) {
  DataBase[[i]][,"ems_ci_co2_trsf_2"] <- DataBase[[i]][,"ems_ci_co2_trsf_2"] + DataBase[[i]][,"ems_ch_co2_2"]
  DataBase[[i]][,"ci_toe_trsf_2"] <- DataBase[[i]][,"ci_toe_trsf_2"] + DataBase[[i]][,"ch_toe_2"]
}



for (j in 1:6) {

data <- as.data.frame(array(,dim=c(36,16)))

for (i in 1:15) {
  if (i < 6) {
  temp <- DataBase[[j]][,va[i]]/DataBase[[j]][,va[17]]
  data[,i] <- temp
  }
  else if(i < 11) {
  temp <- DataBase[[j]][,va[i]]/DataBase[[j]][,va[i-5]]
  data[,i] <- temp
  }
  else if(i < 16) {
  temp <- DataBase[[j]][,va[i]]/DataBase[[j]][,va[i-5]]
  data[,i] <- temp
  }
}
data[,16] = DataBase[[j]][,va[17]]
colnames(data) = kayaname
assign(sc[j],data)
rm(data,temp)

}

data <- as.data.frame(array(,dim=c(36,16)))

Base <- Baseline
Base[,"ems_ci_co2_trsf_0"] <- Base[,"ems_ci_co2_trsf_0"] + Base[,"ems_ch_co2_0"] 
Base[,"ci_toe_trsf_0"] <- Base[,"ci_toe_trsf_0"] + Base[,"ch_toe_0"] 

for (i in 1:15) {
  if (i < 6) {
  temp <- Base[,va_0[i]]/Base[,va_0[17]]
  data[,i] <- temp
  }
  else if(i < 11) {
  temp <- Base[,va_0[i]]/Base[,va_0[i-5]]
  data[,i] <- temp
  }
  else if(i < 16) {
  temp <- Base[,va_0[i]]/Base[,va_0[i-5]]
  data[,i] <- temp
  }
}
data[,16] = Baseline[,va_0[17]]
colnames(data) = kayaname
assign("KAYA_Baseline",data)

Kaya_Base <- list(KAYA_1,KAYA_2,KAYA_3,KAYA_4,KAYA_5,KAYA_6)

rm(data,temp,i,j,sc,va,va_0,kayaname)
# Fin de creation de la base de donnees

```

```{r, echo=FALSE, tidy = TRUE, include = FALSE}
# Decomposition multiplicative

name <- c("D1","D2","D3","D4","D5","D6")
secteur <- c("ems_ci_co2_ind_2","ems_ci_co2_trsp_2","ems_ci_co2_ser_2","ems_ci_co2_trsf_2","ems_ci_co2_ele_2")
secteur0 <- c("ems_ci_co2_ind_0","ems_ci_co2_trsp_0","ems_ci_co2_ser_0","ems_ci_co2_trsf_0","ems_ci_co2_ele_0")
kayaname <- c("S_ind","S_trsp","S_ser","S_trsf","S_ele","E_ind","E_trsp","E_ser","E_trsf","E_ele","I_ind","I_trsp","I_ser","I_trsf","I_ele","V","ind","trsp","ser","trsf","ele","S","E","I")

for (i in 1:6) {
  
  w <- as.data.frame(array(,dim=c(36,16)))
  for (j in 1:5) {
  w[,c(j,j+5,j+10)] <- ((DataBase[[i]][,secteur[j]]-Base[,secteur0[j]])/
          log(DataBase[[i]][,secteur[j]]/Base[,secteur0[j]]))/
     ((DataBase[[i]][,"ems_co2_2"] - Base[,"ems_co2_0"])/
       log(DataBase[[i]][,"ems_co2_2"]/Base[,"ems_co2_0"]))
  }
  w[,16] <- w[,1]+ w[,2]+ w[,3]+ w[,4]+ w[,5]
  data <- exp(w*log(Kaya_Base[[i]]/KAYA_Baseline))
  data <- rapply( data, f=function(x) ifelse(is.nan(x),1,x), how="replace" )
  
  for (k in 1:8) {
    if (k < 6) {
      data <- data %>% add_column(newColname = data[,k] * data[,k+5] * data[,k+10]) 
    }
    else if (k == 6) {
      data <- data %>% add_column(newColname = data[,k-5]*data[,k-4]*data[,k-3]*data[,k-2]*data[,k-1]) 
    }
    else if (k == 7) {
      data <- data %>% add_column(newColname = data[,k-1]*data[,k]*data[,k+1]*data[,k+2]*data[,k+3]) 
    }
    else if (k == 8) {
      data <- data %>% add_column(newColname = data[,k+3]*data[,k+4]*data[,k+5]*data[,k+6]*data[,k+7]) 
    }
  }
  
  colnames(data) <- kayaname
  data <- (data - 1) * 100
  data$year <- c(2015:2050)
  jin <- name[i]
  assign(jin,data)
}

Det <- list(D1,D2,D3,D4,D5,D6)

rm(i,j,jin,name,kayaname,secteur,secteur0,w,data,D1,D2,D3,D4,D5,D6)
```

```{r, echo=FALSE, tidy = TRUE, include = FALSE}
# Decomposition additive
name <- c("D1","D2","D3","D4","D5","D6")
secteur <- c("ems_ci_co2_ind_2","ems_ci_co2_trsp_2","ems_ci_co2_ser_2","ems_ci_co2_trsf_2","ems_ci_co2_ele_2")
secteur0 <- c("ems_ci_co2_ind_0","ems_ci_co2_trsp_0","ems_ci_co2_ser_0","ems_ci_co2_trsf_0","ems_ci_co2_ele_0")
kayaname <- c("S_ind","S_trsp","S_ser","S_trsf","S_ele","E_ind","E_trsp","E_ser","E_trsf","E_ele","I_ind","I_trsp","I_ser","I_trsf","I_ele","V","ind","trsp","ser","trsf","ele","S","E","I")

for (i in 1:6) {
  
  w <- as.data.frame(array(,dim=c(36,16)))
  
  for (j in 1:5) {
    w[,c(j,j+5,j+10)] <- (DataBase[[i]][,secteur[j]]-Base[,secteur0[j]])/
          log(DataBase[[i]][,secteur[j]]/Base[,secteur0[j]])
  }
  
  w[,16] <- w[,1]+ w[,2]+ w[,3]+ w[,4]+ w[,5]
  data <- w*log(Kaya_Base[[i]]/KAYA_Baseline)
  data <- rapply( data, f=function(x) ifelse(is.nan(x),0,x), how="replace" )
  
  for (k in 1:8) {
    if (k < 6) {
      data <- data %>% add_column(newColname = data[,k] + data[,k+5] + data[,k+10]) 
    }
    else if (k == 6) {
      data <- data %>% add_column(newColname = data[,k-5]+data[,k-4]+data[,k-3]+data[,k-2]+data[,k-1]) 
    }
    else if (k == 7) {
      data <- data %>% add_column(newColname = data[,k-1]+data[,k]+data[,k+1]+data[,k+2]+data[,k+3]) 
    }
    else if (k == 8) {
      data <- data %>% add_column(newColname = data[,k+3]+data[,k+4]+data[,k+5]+data[,k+6]+data[,k+7]) 
    }
  }
  
  colnames(data) <- kayaname
  data$year <- c(2015:2050)
  jin <- name[i]
  assign(jin,data)
}

Dif <- list(D1,D2,D3,D4,D5,D6)

rm(i,j,jin,name,secteur,secteur0,w,data,D1,D2,D3,D4,D5,D6)
```

\newpage

# Introduction

# Literature review

## Energy and economy framework in Tunisia (Jin)

Tunisia is one of the northernmost countries in Africa, ranked the most competitive economy in Africa by World Economy Forum in 2009 [@tunisia2022]. The local economy is largely oriented towards services, which account for 43% of GDP in 2019 [@worldbank2020], including the booming IT and tourism industries. Agriculture is another key sector of the Tunisian economy, representing 10.4% of the GDP and employing 12.7% of the working population [@worldbank2020]. Thanks to technical progress of agricultural sector, Tunisia is one of the most productive countries in Africa. Tunisia's industry represents 22.7% of GDP and employs 32.5% of the working population in 2020 [@bnpparibas]. The industrial sectors are mainly export oriented especially for manufacturing, Europe is the destination for more than 75% of Tunisia's exports [@worldbank2020].

Since the Jasmine Revolution on 2011, Tunisia economy has been suffered from the extended recession. The sanitary crisis on 2020 has worsened the already precarious situation. Actually, even before COVID-19 Tunisia's capacity for economic resilience had been drained by years of indecisive public policy-making and growing protectionism [@worldbank]. In early September 2020, the Tunisian parliament finally reversed a government of Tenchnocrats in an attempt to remedy the country's economic situation [@bnpparibas].

Along with the sluggish economy is the huge energy deficit in Tunisia. @irena2021 reported that energy deficit (50% in 2019) has existed in Tunisia over the past two decades, mainly because of the increasing consumption but with the stagnated even declined domestic production in recent years. @giz reported that Tunisia depends for 60% on energy imports, and this number is continuously raising. The energy transition project proclaimed in 2014 aims to reduce energy needs by 34% by 2030, lower subsidies and establish incentive mechanisms favoring profitable and climate friendly investments. However, the challenging is the lack of reliable institutional mechanisms and motivation for enterprises to participate, accompanied with a poorly established service market and weak transmission of knowledge to citizens, especially outside urban area.

The welfare system is based on non-targeted subsidies. According to @albertin2014, the subsidy policy is a pillar of the Tunisian welfare system. Targeted social assistance programs are above the regional average. In 2016, social expenditure represented 3.2 percent of GDP, majority of which was energy and food subsidies [@tunisia2020]. In 2021, the fossil fuel subsidies amounted to \$1,14 billion (2.7% of GDP) [@trésor2021]. Concerning energy subsidies, the government subsidizes liquefied petroleum gas (LPG), natural gas, kerosene, diesel, gasoline, electricity and heavy fuel oil. The effective subsidies by product are represented in figure X. The LPG and the electricity subsidies are the main expenditure items as shown in figure X. A significant part of the energy subsidies are captured by the wealthiest quintile of the population. On the contrary, in 2013, the bottom 40% of the distribution captured only 29% of energy subsidies [@worldbank2014]. According to @cuesta2017 , energy subsidies are also a cornerstone of the development of Tunisian productive sectors. The subsidy system allows firms to buy cheap energy resources. The noncompetitive companies, which employ unskilled workers, rely on the subsidies.

After the revolution, fiscal and equity issues incited the Tunisian government to reduce energy subsidies. In 2012, the prices of gasoline, diesel and electricity increased by 7% [@albertin2014]. In 2014, energy subsidies to cement firms were reduced by half. In 2020, Tunisia has introduced an automatic monthly price adjustment mechanism for petrol and diesel sales, with the aim of eliminating fuel subsidies.

![](Images/Composition%20of%20fuel%20subsidies%20by%20product.jpg)

::: {align="center"}
Fig.X : Composition of fuel subsidies product (source : @tunisia2020)
:::

![](Images/Energy%20subsdies%20received%20by%20welfare%20quintile.jpg)

::: {align="center"}
Fig.X : Energy subsidies received by welfare quintile, 2015/16 (TND millions) (source : @tunisia2020)
:::

## Climate policy

### Carbon tax

### Energy subsidy

Subsidies are defined by @demoor1997 as *'any measure that keeps prices for consumers below the market level or keeps prices for producers above the market level or that reduces costs for consumers and producers by giving direct or indirect support'*. Energy subsidies are a common policy. Their amount is estimated at \$4.7 trillion in 2015 as pointed out @coady2019, which is equivalent to 6.3 percent of Gross Domestic Product . Energy subsidies fluctuate depending on the price of the energy products. From the database of the International Energy Agency, we can notice that the fossil fuel subsidies have [fallen by 42 percent between 2019 and 2020](https://www.iea.org/topics/energy-subsidies) due to the drop of fuel prices.

The energy subsidies are very present in the Middle East, North Africa, Afghanistan and Pakistan region (MENAP). According to @coady2019, MENAP is the fourth region in absolute terms, which subsidized the most energy in 2015. Nevertheless, in relative terms, MENAP is the second, if we take into account the percent of its GDP. The prevalence of energy subsidies in MENAP can be explained by the post-par period. These energy subsidies were introduced, after the decolonization, in Middle East and North Africa region (MENA) in order to stabilize prices and then, became a social protection system [@verme2017].

@fattouh2013 emphasize three positive aspects of the energy subsidies that we saw above :

-   The energy subsidies enhance the incomes of the poorest part of the population. It constitute a core part of the welfare system in the MENA.

-   The energy subsidies help to reduce production costs and to strengthen competitiveness of local firms. Energy subsidies are a tool for industrialization and diversification policy.

-   The regulation of energy prices is used to control inflation and stabilize prices.

Reducing energy subsidies may improve economic welfare and reduce emissions [@aldy2013 ; @coady2019 ; @hahn2021]. @fattouh2013 also highlight unintended consequences of energy subsidies :

-   Energy subsidies raise energy intensity of GDP and reduce energy efficiency rates. Low energy pricing favors the growth of energy-intensive industries and discourage the firms from minimizing energy costs. Fig. X below shows that many energy-intensive countries have also high fossil fuel subsidies as a proportion of their GDP.
-   Energy subsidies distort consumption. Indeed, they cause a fast growth in consumption of primary fuels and electricity. According to @fattouh2013, between 1980 to 2008, the total energy consumption in MENA grew more than 5% annually.
-   Energy subsidies distort investments. The weak implementation of subsidies provoke underinvestment in energy sectors, where the subsidies do not entirely compensate the energy companies. Therefore, end users receive a low quality service.
-   Energy subsides cause fuel shortages because of low prices. The smuggling across borders is also favored by the price differences between countries.
-   Non-targeted subsidies create inequities between social groups (see fig. X. above).

![](Images/Subsidies%20-%20energy%20intensity.jpg)

::: {align="center"}
Fig.X : Energy subsidies and energy intensities by country in 2017 (data : SDG indicators for United Nations Economic Commission for Europe)
:::

### Recycle of gouvernment income for tax (Lucia)

Tax redistribution is the mechanism that allows the government to return to the private economy the revenues that are produced by the instrument [@goulder]. There are many ways in which this redistribution can operate. It can be presented as a lump-sum transfer to households and firms, or as a reduction of taxes that introduce a deformation into the economy as is the case of the labor tax.

# Methodology

## ThreeME model (Bee)

The ThreeME model is a hybrid neo-Keynesian Computable General Equilibrium model (1), which had to be adaptated and calibrated on Tunisian data (2).

### A hybrid neo-Keynesian Computable General Equilibrium model

The [open source](https://github.com/fosem/ThreeME_V3-open) ThreeME model has been developped since 2008 by OFCE (French Economic Observatory), ADEME (French Environment and Energy Management Agency) and NEO (Netherlands Economic Observatory). ThreeME is a Computable General Equilibrium Model (CGEM), with neo-Keynesian features and a hybrid structure.

ThreeME combines several features [@callonnec2013 ; @callonnec2021] :

-   ThreeME is a Computable General Equilibrium Model (CGEM), which takes into account the interactions and feedbacks between supply and demand (see Fig.X). Demand defines supply and in return, supply determines demand through the production factor incomes.

![](Images/Architecture%20of%20a%20CGEM.jpg)

::: {align="center"}
Fig.X : Architecture of CGEM (source : @callonnec2013)
:::

-   ThreeME is a CGEM of neo-Keynesian inspiration. ThreeME differs from Walrasian CGEM in its dynamics and its transition to the long run. Instead of perfect flexibility hypothesis, prices and quantities slowly adjust, because of uncertainties, adjustment costs or temporal boundaries. Prices do not clear supply and demands and market imperfections are also included in the model. Consequently, there are disequilibrium between supply and demand. For instance, involuntary unemployment is possible.

-   The high sectoral disaggregation is a way to describe the transfers of activity from a sector to another. The ThreeME model allows to track sectoral changes in investment, employment or energy consumption.

-   ThreeME is a hybrid model which combines top-down and bottom-up modelling. On one side, the general equilibrium effets are represented. On the other side, the energy disaggregation allows for the analysis of the energy production and consumption. The trade-offs between energy and other production factors and between several energy consumptions are included in the model.

### ThreeMe model Tunisia : Adaptation for a little country in development

ThreeME has already been adapted to Mexico by @landarivera2016 and to Indonesia by @reynes2017. The adaptation of ThreeME to Tunisia has been founded on consultation with Tunisian experts and other stakeholders. Indeed, the sectoral disaggregation was validated by Tunisian stakeholders. At the end, 21 sectors and 18 products were chosen (see Fig.X). The tax structure is based on the supply and use table (SUT) of the national accounts.

![](Images/Sectoral%20disaggregation.jpg)

::: {align="center"}
Fig.X : Sectoral disaggregation
:::

The required data are economic data from national accounts, in particular from Input-Output Tables (IOTs), physical data from energy balance and detailed tax data by product. These data were collected from Tunisian institutions, in particular ANME (National Agency for Energy Management), INS (National Institute of statistics), ONE (National Energy Observatory), STEG (Tunisian Company of Electricity and Gas), ITCEQ (Tunisian Institute of Competitiveness and Quantitative Studies), Ministry of Energy, Mines and Energy Transition and the Ministry of Economic Development, Investment and International Cooperation.

## Description of scenario (Lucia)

with/without redistribution? \*Voir si peut être on déplace cette partie

We work on six different scenarios that simulate the implementation of six alternative environmental policies.

Scenario 1 : Implementation of a carbon tax from 2021 without redistribution of the revenues of the tax in the economy - they are used to reduce public debt.

Scenario 2 : Carbon tax with recycling of revenues that are redirected to the Energy Transition Fund. In fact, a part is given back to households and a portion is devoted to "non-polluting" businesses.

Scenario 3 : Fossil fuels subsidies removal (without recycling).

Scenario 4 : Fossil fuels subsidies removal (with recycling). A part is given back to households and a portion is given to enterprises in proportion to the employment of each sector in the total salaried labor force.

Scenario 5 : Significant penetration of Renewable Energies in the electrical mix (80% by 2050)

Scenario 6 : Combination of scenarios 2, 4 and 5.

### Tax carbon scenario

Avant 2030, le niveau de la TC est calculé de façon a couvrir 100% des besoins du FTE Il passe de 1.1 à 9 DT/tCO2 Après 2030, la trajectoire de la TC est définie de façon à atteindre les objectifs de réduction d'émission à 2050 D'après les hypothèse des substitutions retenues dans ThreeME, l'atteinte d'un factor 5 en 2050 par rapport au niveau de 2020 nécessite une hause régulière de 9 DT/tCO2 à 372 DT/ tCO2. En plus de la TC des signaux prix ont été introduits afin d'atteindre les objectifs de consommations d'énergie par source

```{r, echo=FALSE}
ggplot() + 
  geom_line( data = S1, aes(x = year,y = rco2tax_vol.1000, group = 1)) +
    labs(x= "year", y = "Carbon tax rate \n (in constant Tunisian dinars on 2015 per ton of CO2) ", title = "Fig.X Evolution of carbon tax in Tunisia") +
  scale_x_continuous(breaks=seq(2015,2050,5)) + 
  theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5))

```

### Energy subsidy removal scenario

```{r, echo=FALSE}

ggplot() + 
  geom_line( data = S3, aes(x = year,y = abs(esub_gdp_2.gdp_2.1000000..ems_co2_2.1000.), group = 1)) +
    labs(x= "Year", y = "Energy subventions 
         (in 2015 constant Tunisian dinars per ton of CO2)", title = "Scenarios with lifting of energy subsidies. Energy subsidies.") +
  scale_x_continuous(breaks=seq(2015,2050,5))+ theme(axis.title=element_text(size=9))

# valeur négative passée en valeur absolue 

```

### Renewable energy scenario

### National Low-Carbon Strategy scenario

## Choice of evaluation indicators

### Data structure

All the indicators used in the analysis are in exact hat algebra, meaning the proportional variation to Baseline scenario. time scale of data key indicator: two dimensions economy and environnement

### Kaya identity (Jin)

The Kaya identity, firstly proposed by [@kaya1989], is an identity where the total emission of carbon dioxide can be explained by four product driving forces as population, Gross Domestic Product (GDP) per capita, enerny intensity over GDP and carbon intensity over energy consumption [@kayaide2021]. It is expressed in the form:

$$ C = POP \cdot \frac{GDP}{POP} \cdot \frac{TEC}{GDP} \cdot \frac{C}{TEC} \tag{1}$$

where:

-   POP is global population;
-   GDP is gross domestic product;
-   TEC is total energy consumption;
-   C is total emission of carbon dioxide;

And:

-   GDP/POP is GDP per capita describing the economical activities within a period;
-   TEC/GDP is energy intensity;
-   C/TEC is carbon intensity;

In this study, we introduced an extension of Kaya identity to explain how different driving forces influenced the total emission for different scenarios. Firstly, a extended Kaya identity is used to analysis CO~2~ emission with the aggregated factors, then we couple with Logarithmic Mean Divisia Index (LMDI) method to decomposite CO~2~ emission at the sectorial level.

We modified the function of Kaya identity mentioned above to adapt our model assumption, where we integrated a new driving force, named economy structure, to decomposite emissions driving force at sectorial level. The five economic sectors considered in ThreeME Tunisia model are: Industry and Agriculture, Service, Transportation, Energy Transformation and Electricity. However, we did not take population into consideration because its increasing rate remains still over time for all our scenarios and is considered as an exogenous variable in ThreeME model.

Therefore, the CO~2~ emission can be written as:

$$  C_{tot} = \Sigma C_{i} = \Sigma( VA \cdot \frac{VA_{i}}{VA} \cdot \frac{EC_{i}}{VA_{i}} \cdot \frac{CE_{i}}{EC_{i}} )=  \Sigma( V \cdot S_{i} \cdot E_{i} \cdot I_{i}) \tag{2}$$ where C~tot~ is overall CO~2~ emission, C~i~ is CO~2~ emission of economic sector i, VA is total added value, VA~i~ is added value of sector i, EC~i~ is total energy consumption by sector i, CE~i~ is CO~2~ emission arising from sector i. According to equation 8, total CO~2~ emission can be explained by four driving forces, including one aggregated indicator, overall economic activities V, and three sectorial indicators, share of total added value of sector i S~i~, energy intensity over added value of sector i E~i~ and carbon intensity over energy consumption of sector i I~i~. Especially, S~i~ can be interpreted as economy structure of Tunisia, @grubb2015 and @kanitkar2015 found that for a developing country, this term could be a key variable determining the future emissions pathway.

The effects of driving forces can be expressed in two ways: multiplicative and additive form, where multiplicative deviation $D_{tot}$ is the ratio of total CO~2~ emission between policy scenario and baseline scenario (equation 3), and additive deviation $\Delta C_{tot}$ is the difference of total CO~2~ emission (equation 4). The two expressions are shown below:

$$ D_{tot} =\frac{C_{2}}{C_{0}} = \Pi(\frac{V_{2}}{V_{0}} \cdot \frac{S_{2,i}}{S_{0,i}} \cdot \frac{E_{2,i}}{E_{0,i}}  \cdot \frac{I_{2,i}}{I_{0,i}}) = D_{V}  \cdot  D_{S} \cdot D_{E} \cdot D_{I} = D_{V}  \cdot \Pi ( D_{S_{i}} \cdot D_{E_{i}} \cdot D_{I_{i}}) \tag{3}$$

$$ \Delta C_{tot} = C_{2} - C_{0} = \Delta C_{V} + \Delta C_{S} + \Delta C_{E} + \Delta C_{I} = \Delta C_{V} + \Sigma( \Delta C_{S_{i}} + \Delta C_{E_{i}} + \Delta C_{I_{i}}) \tag{4}$$ where subscript $tot$ represents overall change of emission, subscript 0 and 2 mean baseline scenario and policy scenario respectively. Hence we obtain the index $D_{V}$, $D_{S}$, $D_{E}$ and $D_{I}$, meaning the deviation of emissions due to change of overall economic activities, economy structure, energy intensity and carbon intensity, while $\Delta C_{V}$, $\Delta C_{S}$, $\Delta C_{E}$ and $\Delta C_{I}$ depict the difference of emissions related to change of driving forces.

Now we expect to identify the effect of each driving force at a sectorial level, to do this, we used a LMDI method proposed by @ang1997 and @ang2005. For multiplicative form, we have:

$$ D_{X} = exp ( \Sigma \frac{(C_{2,i}-C_{0,i})/(lnC_{2,i}-lnC_{0,i})}{(C_{2}-C_{0})/(lnC_{2}-lnC_{0})} \cdot ln \frac{X_{2,(i)}}{X_{0,(i)}} ) \tag{11}$$ $$ \Delta C_{X} =  \Sigma (\frac{C_{2,i}-C_{0,i}}{lnC_{2,i}-lnC_{0,i}} \cdot ln\frac{X_{2,(i)}}{X_{0,(i)}}) \tag{12} $$ where $C_{2}$ is total emission of policy scenario, $C_{0}$ is total emission of baseline, $C_{2,i}$ is emission of policy scenario arising from sector i, $C_{0,i}$ is emission of baseline arising from sector i, $D_{X}$ and $\Delta C_{X}$ represent multiplicative and additive index of driving force $X$, $X_{2,(i)}$ is value of driving force $X$ of policy scenario for sector i, $X_{0,(i)}$ is value of driving force $X$ of baseline for sector i.

# Results et discussions

In this section we will analyse the results obtained for the different scenarios for the different variables taken into account.

## Importance of redistribution (Lucia)

Here we will analyse the influence of the redistribution of both the tax and the removed energy subsidy. We will observe the impact of the redistribution on the economical and environmental aspects. We will focus on GDP variation and unemployment when it comes to the economical aspect and we will analyse the evolution of emissions for the environmental aspect.

Firstly, we will analyse the redistribution of the carbon tax. The figure below show the variation in GDP in relation to the baseline for both the scenarios carbon tax with and without redistribution. We observe that the evolution of the curves is opposite and symmetric in relation to the x-axis, the scenario with redistribution showing a marked increase in GDP.

```{r, echo=FALSE}
ggplot() + 
  geom_line( data = Sc1, aes(x = year,y = gdp_2, group = 1, color = "Tax_SansDis")) + 
  geom_line( data = Sc2, aes(x = year,y = gdp_2, group = 1, color = "Tax_AvecDis")) + 
  labs(y = "Variation de PIB en %", title = "PIB en volume. Ecart au scénario de référence") +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

Then when we analyse the *level of employment* we can see that the redistribution operates an increase on it in relation to the baseline, when the scenario of a carbon tax without redistribution produce a decrease in the level of employment. That is consistent with the fact that the

```{r, echo=FALSE}

ggplot() + 
  geom_line( data = Sc1, aes(x = year,y = f_l_2, group = 1, color = "Taxe sans redistribution")) + 
  geom_line( data = Sc2, aes(x = year,y = f_l_2, group = 1, color = "Tax avec redistribution")) + 
  labs(y = "Variation de l'emploi en %", title = "Emploi. Ecart au scénario de référence") +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

emissions

```{r, echo=FALSE}
ggplot() + 
  geom_line( data = Sc1, aes(x = year,y = ems_co2_2, group = 1, color = "Tax_SansDis")) + 
  geom_line( data = Sc2, aes(x = year,y = ems_co2_2, group = 1, color = "Tax_AvecDis")) + 
  labs(y = "Variation d'émission en %", title = "Evolution de variation d'émission") +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

PIB

```{r, echo=FALSE}
ggplot() + 
  geom_line( data = Sc3, aes(x = year,y = gdp_2, group = 1, color = "Sub_SansDis")) + 
  geom_line( data = Sc4, aes(x = year,y = gdp_2, group = 1, color = "Sub_AvecDis")) + 
  labs(y = "Variation de PIB en %", title = "PIB en volume. Ecart au scénario de référence") +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

chomage :

```{r, echo=FALSE}

ggplot() + 
  geom_line( data = Sc3, aes(x = year,y = f_l_2, group = 1, color = "Sub sans redistribution")) + 
  geom_line( data = Sc4, aes(x = year,y = f_l_2, group = 1, color = "Sub avec redistribution")) + 
  labs(y = "Variation de l'emploi en %", title = "Emploi. Ecart au scénario de référence") +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

Il peut être intéressant de faire un commentaire sur le salaire brut

```{r, echo=FALSE}

ggplot() + 
  geom_line( data = S1_Macro, aes(x = year,y = Salaire.nominal.brut, group = 1, color = "Taxe_SansRedis")) + 
  geom_line( data = S2_Macro, aes(x = year,y = Salaire.nominal.brut, group = 1, color = "Taxe_AvecRedis")) + 
  geom_line( data = S3_Macro, aes(x = year,y = Salaire.nominal.brut, group = 1, color = "Subvention_SansRedis")) + 
  geom_line( data = S4_Macro, aes(x = year,y = Salaire.nominal.brut, group = 1, color = "Subvention_AvecRedis")) + 
  geom_line( data = S5_Macro, aes(x = year,y = Salaire.nominal.brut, group = 1, color = "ENR")) + 
  geom_line( data = S6_Macro, aes(x = year,y = Salaire.nominal.brut, group = 1, color = "SNBC")) +
  labs(y = "Salaire nominal brut (%)", title = "Salaire nominal brut. Écart au scénario de référence en pourcentage") +
  scale_x_continuous(breaks=seq(2015,2050,5))


```

émissions :

```{r, echo=FALSE}
ggplot() + 
  geom_line( data = Sc3, aes(x = year,y = ems_co2_2, group = 1, color = "Sub_SansDis")) + 
  geom_line( data = Sc4, aes(x = year,y = ems_co2_2, group = 1, color = "Sub_AvecDis")) + 
  labs(y = "Variation d'émission en %", title = "Evolution de variation d'émission") +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

Tableau Taxe sans redistribution

```{r eval=FALSE, dev='jpeg'}

tablename <- c("GDP in volume","Household consumption","Investment","Exports","Imports","Household disposable income","Household consumption price index","production price index","Added value price index","Intermediate consumption price index","Export price index","Import price index","Gross nominal wage","Real cost of labor","Wage employment rate (in thousands)","Unemployment rate (in point)","Trade balance (in point of GDP)","Public budget balance (in points of GDP)","Public debt (in points of GDP)", "CO2 emissions")

Table_Macro_CT <- S1_Macro[c("2021","2025","2030","2035","2040","2045","2050"),1:20]
Table_Macro_CT <- t(Table_Macro_CT)
Table_Macro_CT <- round(Table_Macro_CT,digits = 2)
row.names(Table_Macro_CT) <- tablename

kable(Table_Macro_CT, booktabs = T, longtable = T, linesep = "", caption = "Macroeconomic impacts of Carbon tax scenario in percent deviation to Baseline") %>% 
kable_styling(latex_options = c("striped","hover","repeat_header"), full_width = T) %>% 
row_spec(0, bold = T)
```

Tableau Taxe avec redistribution

```{r eval=FALSE, dev='jpeg'}

tablename <- c("GDP in volume","Household consumption","Investment","Exports","Imports","Household disposable income","Household consumption price index","production price index","Added value price index","Intermediate consumption price index","Export price index","Import price index","Gross nominal wage","Real cost of labor","Wage employment rate (in thousands)","Unemployment rate (in point)","Trade balance (in point of GDP)","Public budget balance (in points of GDP)","Public debt (in points of GDP)", "CO2 emissions")

Table_Macro_CT <- S2_Macro[c("2021","2025","2030","2035","2040","2045","2050"),1:20]
Table_Macro_CT <- t(Table_Macro_CT)
Table_Macro_CT <- round(Table_Macro_CT,digits = 2)
row.names(Table_Macro_CT) <- tablename

kable(Table_Macro_CT, booktabs = T, longtable = T, linesep = "", caption = "Macroeconomic impacts of Carbon tax scenario in percent deviation to Baseline") %>% 
kable_styling(latex_options = c("striped","hover","repeat_header"), full_width = T) %>% 
row_spec(0, bold = T)
```

Tableau subvention sans redistribution

```{r eval=FALSE, dev='jpeg'}

tablename <- c("GDP in volume","Household consumption","Investment","Exports","Imports","Household disposable income","Household consumption price index","production price index","Added value price index","Intermediate consumption price index","Export price index","Import price index","Gross nominal wage","Real cost of labor","Wage employment rate (in thousands)","Unemployment rate (in point)","Trade balance (in point of GDP)","Public budget balance (in points of GDP)","Public debt (in points of GDP)", "CO2 emissions")

Table_Macro_CT <- S3_Macro[c("2021","2025","2030","2035","2040","2045","2050"),1:20]
Table_Macro_CT <- t(Table_Macro_CT)
Table_Macro_CT <- round(Table_Macro_CT,digits = 2)
row.names(Table_Macro_CT) <- tablename

kable(Table_Macro_CT, booktabs = T, longtable = T, linesep = "", caption = "Macroeconomic impacts of Carbon tax scenario in percent deviation to Baseline") %>% 
kable_styling(latex_options = c("striped","hover","repeat_header"), full_width = T) %>% 
row_spec(0, bold = T)
```

Tableau subvention avec redistribution

```{r eval=FALSE, dev='jpeg'}

tablename <- c("GDP in volume","Household consumption","Investment","Exports","Imports","Household disposable income","Household consumption price index","production price index","Added value price index","Intermediate consumption price index","Export price index","Import price index","Gross nominal wage","Real cost of labor","Wage employment rate (in thousands)","Unemployment rate (in point)","Trade balance (in point of GDP)","Public budget balance (in points of GDP)","Public debt (in points of GDP)", "CO2 emissions")

Table_Macro_CT <- S4_Macro[c("2021","2025","2030","2035","2040","2045","2050"),1:20]
Table_Macro_CT <- t(Table_Macro_CT)
Table_Macro_CT <- round(Table_Macro_CT,digits = 2)
row.names(Table_Macro_CT) <- tablename

kable(Table_Macro_CT, booktabs = T, longtable = T, linesep = "", caption = "Macroeconomic impacts of Carbon tax scenario in percent deviation to Baseline") %>% 
kable_styling(latex_options = c("striped","hover","repeat_header"), full_width = T) %>% 
row_spec(0, bold = T)
```

## Carbon tax (jin)

As the carbon tax before 2030 stays at a moderate level, the impacts of this policy are therefore limited, while the significant effects are observed during the later period from 2030 to 2050 when a much stronger tax carbon is implemented. The macroeconomic impacts are summarized in table 1, the results are expressed as percentage deviation from Baseline scenario.

Generally speaking, the policy of carbon tax with redistribution of government revenue has a positive impact on Tunisia's economy. Whereas GDP increases slightly up to 0.13% with respect to baseline on 2030, the relatively rapid augmentation is observed from 2030 to 2050. At the horizon of 2050, it reaches a highest level (+1.93%) thanks to the carbon tax policy. In the meantime, social welfare is improved with the same rhythme as GDP growth, with a higher consumption level (+4.20%) and a higher disposable income (+4.17%) on 2050.

```{r eval=FALSE, dev='jpeg', echo = FALSE}

tablename <- c("GDP in volume","Household consumption","Investment","Exports","Imports","Household disposable income","Household consumption price index","production price index","Added value price index","Intermediate consumption price index","Export price index","Import price index","Gross nominal wage","Real cost of labor","Wage employment rate (in thousands)","Unemployment rate (in point)","Trade balance (in point of GDP)","Public budget balance (in points of GDP)","Public debt (in points of GDP)", "CO2 emissions")

Table_Macro_CT <- S2_Macro[c("2021","2025","2030","2035","2040","2045","2050"),1:20]
Table_Macro_CT <- t(Table_Macro_CT)
Table_Macro_CT <- round(Table_Macro_CT,digits = 2)
row.names(Table_Macro_CT) <- tablename

kable(Table_Macro_CT, booktabs = T, longtable = T, linesep = "", caption = "Macroeconomic impacts of Carbon tax scenario in percent deviation to Baseline") %>% 
kable_styling(latex_options = c("striped","hover","repeat_header"), full_width = T) %>% 
row_spec(0, bold = T)
```

::: {align="center"}
Table.X :Macroeconomic impacts of Carbon tax scenario in % deviation to Baseline
:::

An intuitive influence of carbon tax is that the price of internal market will raise, which is in line with our model output: higher household consumption price of 9.49% with 11.33% and 13.14% for production price and intermediate consumption price, respectively. The increasing cost of household and company will force them to choose the substitution with less CO2 emissions, thus reducing their cost. The variation of internal price also has an impact on the competitiveness of local goods on international market, causing a recession for exportation and a boost for importation.

It is interesting to note that the implemented policy can alleviate social poverty to some extent. We observed, for example, the continuous growth of wage employment. It will then reinforce the acceptability of the climate policy.

```{r, echo = FALSE}

ggplot() + 
  geom_line( aes(x = Det[[2]][,"year"],y = S2[,"ems_ci_co2_2"]/Baseline[,"ems_ci_co2_0"]*100 - 100, group = 1, color = "Total reduction")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"V"], group = 1, color = "Economic activities")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"S"], group = 1, color = "Economy structure")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"E"], group = 1, color = "Energy intensity")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"I"], group = 1, color = "Carbon intensity")) + 
  labs(x = "year", y = "Index LMDI \nin % deviation of emission to Baseline", title = "Fig.x Multiplicative contribution for overall emissions variation \n Carbon tax with redistribution") +
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

Along with the economical growth, we find that the emissions reduction of 42.2% by 2050 is achieved, then we are now interested in its pathway. To do this, we firstly employ our extended Kaya identity to clarify the main driving forces, where, a priori, Economic activities are expected to have positive effects on emissions, whilst Energy intensity and Carbon intensity should have negative effects. Figure X. presents the results of all the aggregated driving forces. We observe that economy structure has a significantly positive and growing impact until 2043 where it reaches the peak raising 7947.48 Kt CO2 (+19,38%) with regard to baseline, then it begins to decline to 5650,17 Kt CO2 (+12,46%) on 2050. On the other hand, carbon intensity and energy intensity show the negative and monotone trend, the former reducing 7128.35 Kt CO2 (-13.77%) on 2050 and 30715.93 Kt CO2 (-47.18%) for the later. However, the influence of economic activities is negligible (+886,37 Kt CO2 & +1.86%), revealing that even though the total production remains relatively invariable, the revolution of economy structure and production methods could still strongly impact the emissions pathway.

```{r, echo = FALSE}

ggplot() + 
  geom_line( aes(x = Det[[2]][,"year"],y = S2_Macro[,"Prix.à.la.consommation"], group = 1, color = "Consumption price")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = S2_Macro[,"Prix.à.la.Production"], group = 1, color = "Production price")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = S2_Macro[,"Prix.de.la.valeur.ajoutée"], group = 1, color = "Added value price")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = S2_Macro[,"Prix.des.consommations.intermédiaires"], group = 1, color = "Intermediate consumption price")) + 
  labs(x = "year", y = "Price \n in % deviation to Baseline", title = "Fig.x Evolution of prices on Tunisia's market with regard to baseline scenario") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

So how do these driving forces work exactly to impact emissions? To answer this question, we conduct a sectorial analysis with the help of our extended Kaya identity. Fig.X depicts the evolution of economy structure for different sectors. Electricity sector has a positive impact while energy transformation has a negative one, with all other sectors staying relatively stable. It indicates the development of electricity production, and recession of another, standing for the substitution of electricity over fossil fuels. Compared with fossil fuels, electricity is potentially less pollutant because it is the final conversion of renewable energies.

```{r, echo=FALSE}

ggplot() + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"S"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"S_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"S_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"S_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"S_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"S_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI \nin % deviation of emission to Baseline", title = "Fig.x Multiplicative contribution of economy structure for overall emissions \n Carbon tax with redistribution") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

```{r, echo=FALSE}

z <- c(Sc2[,"va_ind_2"],Sc2[,"va_trsp_2"],Sc2[,"va_ser_2"],Sc2[,"va_trsf_2"],Sc2[,"va_ele_2"])
x <- rep(Sc2[,"year"], times = 5)
Legend <- rep(c("Industry & agriculture","Transportation","Services","Energy Transformation","Electricity"), each = 36)

ggplot(
  mapping = aes(
               x = x, 
               y = z, 
               fill = Legend,
               group = 1)
               ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Added value \n in % deviation to Baseline", title = "Fig.x Revolution of economy structure in Tunisia \nfor Carbon tax with redistribution scenario, \n expressed by added value variation with regard to Baseline scenario") + 
      theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

rm(z,x,Legend)
```

The carbon tax induces the increasing investment for all sectors except energy transformation, firstly to accelerate the penetration of renewable energies in electricity mix and secondly, to reduce the consumption of fossil fuels especially for energy intensive sectors. We observe then the improvement of energy efficiency, in another word reduction of energy intensity, for all the sectors of Tunisia's economy, especially for electricity and industry & agriculture (Fig.x). However, the other sectors display slight reduction of energy intensity. For example, the transportation sector consume majorly jet fuel for aircraft and diesel for container ship. Electrification faces still huge challenges for long distance transportation. The inertia of energy demand thus exists in such a sector despite of the increasing cost for carbon dioxide emission.

```{r, echo = FALSE}

ggplot() + 
  geom_line( aes(x = Sc2[,"year"],y = Sc2[,"ia_ind_2"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Sc2[,"year"],y = Sc2[,"ia_trsp_2"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Sc2[,"year"],y = Sc2[,"ia_ser_2"], group = 1, color = "Services")) + 
  geom_line( aes(x = Sc2[,"year"],y = Sc2[,"ia_trsf_2"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Sc2[,"year"],y = Sc2[,"ia_ele_2"], group = 1, color = "Electricity")) + 
  labs(x = "year", y = "Investment \n in % deviation to Baseline", title = "Fig.x Investment for different sectors in Tunisia") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

```{r, echo = FALSE}
ggplot() + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"E"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"E_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"E_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"E_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"E_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"E_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI \n in % deviation of emission to Baseline", title = "Fig.x Multiplicative contribution of energy intensity for overall emissions \n Carbon tax with redistribution") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

Fig.x shows how energy consumption varies with the carbon tax, which can be explained by improvement of energy intensity. As what we discussed above, we can find more and more diminished energy demand for all the economic sectors and for household. And one more time, we observe the inertia for transportation and services. Even though there is not noticeable amelioration of energy intensity for energy transformation, the overall shrinkage of the sector explains the energy demand profile.

```{r, echo=FALSE}
z <- c(S2[,"ci_toe_ind_2"]-Baseline[,"ci_toe_ind_0"],S2[,"ci_toe_trsp_2"]-Baseline[,"ci_toe_trsp_0"],S2[,"ci_toe_ser_2"]-Baseline[,"ci_toe_ser_0"],S2[,"ci_toe_trsf_2"]-Baseline[,"ci_toe_trsf_0"],S2[,"ci_toe_ele_2"]-Baseline[,"ci_toe_ele_0"],S2[,"ch_toe_2"]-Baseline[,"ch_toe_0"])
x <- rep(S2[,"year"], times = 6)
Legend <- rep(c("Industry & agriculture","Transportation","Services","Energy transformation","Electricity","Household"), each = 36)

ggplot(
  mapping = aes(
               x = x, 
               y = z, 
               fill = Legend,
               group = 1)
               ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Energy consumption \n in tep difference to Baseline ", title = "Fig.X Evolution of energy consumption by different sectors, \nthe difference with respect to Baseline scenario") + 
  theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

rm(z,x,Legend)
```

The energy intensity represents the choice of production technology considering whether it is energy intensive or not, whilst the carbon intensity describes how carbon tax leads the economy to choose the types of energy. We notice a moderate fall for industry & agriculture and energy transformation, meaning the transition towards energies with less emission. The electricity mix is exogenous according to our modelling assumptions, that is why the carbon tax has no effect on it, whereas it might be wildly influenced by climate policies in the real situation. It is worthy to mention here that energy consumption by household are almost from energy transformation sector, so we integrated household energy consumption into energy transformation sector. In fact, the reduction of carbon intensity observed here in energy transformation sector is arose by a different energy mix of household rather than the sector itself.

```{r, echo = FALSE}
ggplot() + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"I"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"I_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"I_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"I_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"I_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[2]][,"year"],y = Det[[2]][,"I_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI \n in % deviation of emission to Baseline", title = "Fig.x Multiplicative contribution of carbon intensity for overall emissions \n Carbon tax with redistribution") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

As the carbon tax induces the production of green electricity (with less pollution per unit of energy production), the energy consumers then have a more environmental friendly alternative other than fuel. Even though maybe they are not intended to care about the climate change, using this alternative enables them to cut back their costs. Therefore, we see the rapid shifting from fossil fuel to electricity for industry & agriculture and the household, and reaching nearly a half of their energy consumption until 2050 like depicted in Fig.X to X. For industry & agriculture, electricity mainly offsets a part of natural gas demand, which hints the electrification of heating unit for instance. As for household, the wild spread of electrical or hybrid cars reduces the domand for fossil fuel.

```{r, echo = FALSE}
z_1 <- c(
       S2[,"ci_toe_cfut_ind_2"]/S2[,"ci_toe_ind_2"],
       S2[,"ci_toe_cfuh_ind_2"]/S2[,"ci_toe_ind_2"],
       S2[,"ci_toe_cgas_ind_2"]/S2[,"ci_toe_ind_2"],
       S2[,"ci_toe_cele_ind_2"]/S2[,"ci_toe_ind_2"])
x_1 <- rep(Baseline[,"year"], times = 4)
Legend <- rep(c("Fuels for transportation","Fuels for other use","Natural gas","Electricity"), each = 36)

Fig.1 <-
  ggplot(
  mapping = aes(
                x = x_1, 
                y = z_1, 
                fill = Legend,
                group = 1)
  ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Share of energy consumption", title = "Fig.x Energy mix of Industry & Agriculture for Carbon tax scenario") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

z_2 <- c(
       Baseline[,"ci_toe_cfut_ind_0"]/Baseline[,"ci_toe_ind_0"],
       Baseline[,"ci_toe_cfuh_ind_0"]/Baseline[,"ci_toe_ind_0"],
       Baseline[,"ci_toe_cgas_ind_0"]/Baseline[,"ci_toe_ind_0"],
       Baseline[,"ci_toe_cele_ind_0"]/Baseline[,"ci_toe_ind_0"])
x_2 <- rep(Baseline[,"year"], times = 4)
Legend <- rep(c("Fuels for transportation","Fuels for other use","Natural gas","Electricity"), each = 36)

Fig.2 <-
  ggplot(
  mapping = aes(
                x = x_2, 
                y = z_2, 
                fill = Legend,
                group = 1)
  ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Share of energy consumption", title = "Fig.x Energy mix of Industry & Agriculture for Baseline scenario") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))


ggarrange(Fig.1, Fig.2, ncol = 1, common.legend = T, legend = "right")

```

```{r, echo = FALSE}
z_1 <- c(
       S2[,"ch_toe_cfut_2"]/S2[,"ch_toe_2"],
       S2[,"ch_toe_cfuh_2"]/S2[,"ch_toe_2"],
       S2[,"ch_toe_cgas_2"]/S2[,"ch_toe_2"],
       S2[,"ch_toe_cele_2"]/S2[,"ch_toe_2"]
        )
x_1 <- rep(Baseline[,"year"], times = 4)
Legend <- rep(c("Fuels for transportation","Fuels for other use","Natural gas","Electricity"), each = 36)

Fig.1 <-
  ggplot(
  mapping = aes(
                x = x_1, 
                y = z_1, 
                fill = Legend,
                group = 1)
  ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Share of energy consumption", title = "Fig.x Energy mix of household consumption for Carbon tax scenario") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

z_2 <- c(
       Baseline[,"ch_toe_cfut_0"]/Baseline[,"ch_toe_0"],
       Baseline[,"ch_toe_cfuh_0"]/Baseline[,"ch_toe_0"],
       Baseline[,"ch_toe_cgas_0"]/Baseline[,"ch_toe_0"],
       Baseline[,"ch_toe_cele_0"]/Baseline[,"ch_toe_0"]
       )
x_2 <- rep(Baseline[,"year"], times = 4)
Legend <- rep(c("Fuels for transportation","Fuels for other use","Natural gas","Electricity"), each = 36)

Fig.2 <-
  ggplot(
  mapping = aes(
                x = x_2, 
                y = z_2, 
                fill = Legend,
                group = 1)
  ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Share of energy consumption", title = "Fig.x Energy mix of household consumption for Baseline scenario") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))


ggarrange(Fig.1, Fig.2, ncol = 1, common.legend = T, legend = "right")

```

## Energy subsidies removal (bee)

### Economic impacts


::: {align="center"}
Table.X : Macroeconomic impacts of Energy subsidies removal scenario in % deviation to Baseline!
:::

```{r eval=FALSE, dev='jpeg', include=FALSE}

tablename <- c("GDP in volume","Household consumption","Investment","Exports","Imports","Household disposable income","Household consumption price index","production price index","Added value price index","Intermediate consumption price index","Export price index","Import price index","Gross nominal wage","Real cost of labor","Wage employment rate (in thousands)","Unemployment rate (in point)","Trade balance (in point of GDP)","Public budget balance (in points of GDP)","Public debt (in points of GDP)", "CO2 emissions")

Table_Macro_CT <- S4_Macro[c("2021","2025","2030","2035","2040","2045","2050"),1:20]
Table_Macro_CT <- t(Table_Macro_CT)
Table_Macro_CT <- round(Table_Macro_CT,digits = 2)
row.names(Table_Macro_CT) <- tablename

kable(Table_Macro_CT, booktabs = T, longtable = T, linesep = "", caption = "Macroeconomic impacts of Lifting energy subsidies scenario with redistribution in percent deviation to Baseline") %>% 
kable_styling(latex_options = c("striped","hover","repeat_header"), full_width = T) %>% 
row_spec(0, bold = T)
```

```{r, echo = FALSE}


BROWN <- "#AD8C97"
BROWN_DARKER <- "#7d3a46"
GREEN <- "#2FC1D3"
BLUE <- "#076FA1"
GREY <- "#C7C9CB"
GREY_DARKER <- "#5C5B5D"
RED <- "#E3120B"


Sectors <- c("Industry and agriculture","Transports","Services","Energy transformation","Electricity")

stacked_data <- data.frame(
  year = rep(S6[,"year"], times = 5),
  percent = c(Sc4[,"ia_ind_2"],Sc4[,"ia_trsp_2"],Sc4[,"ia_ser_2"],Sc4[,"ia_trsf_2"],Sc4[,"ia_ele_2"]),
  Sectors = factor(rep(Sectors, each = 36), levels = rev(Sectors))
)

library(forcats)

plt2 <- ggplot(stacked_data) +
  # color = "white" indicates the color of the lines between the areas
  geom_area(aes(year, percent, fill = fct_reorder(Sectors, abs(percent),.desc = TRUE)), position = 'identity', color = "white") +
  scale_fill_manual(values = c(GREY, BROWN, GREEN, BLUE, BROWN_DARKER))+
  labs(x = "year", y = "Investment (in %)", title = "Change in investment by sector \nin deviation from the baseline scenario. \nEnergy subsidy removal scenario with redistribution. \n.") + 
      theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))+
guides(fill=guide_legend(title="Sectors"))

plt2

```

### Environmental and energy impacts

```{r}

ggplot() + 
  geom_line(aes(x = S4[,"year"],y = S4[,"ems_co2_2"]/Baseline[,"ems_co2_0"], group = 1, color = "Total effect"), size = 1.0) + 
  geom_line(aes(x = S4[,"year"],y = S4[,"va_2"]/Baseline[,"va_0"], group = 1, color = "GDP per capita")) + 
  geom_line(aes(x = S4[,"year"],y = ((S4[,"ci_toe_2"]+S4[,"ch_toe_2"])/(Baseline[,"ci_toe_0"]+Baseline[,"ch_toe_0"]))/(S4[,"va_2"]/Baseline[,"va_0"]), group = 1, color = "Energy intensity")) + 
  geom_line(aes(x = S4[,"year"],y =  (S4[,"ems_co2_2"]/Baseline[,"ems_co2_0"])/((S4[,"ci_toe_2"]+S4[,"ch_toe_2"])/(Baseline[,"ci_toe_0"]+Baseline[,"ch_toe_0"])), group = 1, color = "Carbon Intensity")) + 
  labs(x = "year", y = "Index of Kaya identity", title = "Kaya identity at aggragated level \nEnergy subsidy with redistribution scenario") +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

```{r, echo = FALSE}

ggplot() + 
  geom_line( aes(x = Det[[4]][,"year"],y = S4[,"ems_ci_co2_2"]/Baseline[,"ems_ci_co2_0"]*100 - 100, group = 1, color = "Total reduction")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"V"], group = 1, color = "Economic activities")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"S"], group = 1, color = "Economy structure")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"E"], group = 1, color = "Energy intensity")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"I"], group = 1, color = "Carbon intensity")) + 
  labs(x = "year", y = "Index LMDI in % \n emission deviation to Baseline", title = "Fig.x Multiplicative contribution for overall emissions variation \n Energy subventions removal with redistribution") +
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

```{r, echo = FALSE}


z <- c(Dif[[4]][,"V"],Dif[[4]][,"S"],Dif[[4]][,"E"],Dif[[4]][,"I"])
x <- rep(Dif[[4]][,"year"], time = 4)
Legend <- rep(c("Ecnonomic activities","Economy structure","Energy intensity","Carbon intensity"), each = 36)

  ggplot() + 
  geom_bar( aes(x = x, y = z, fill = Legend, group = 1), stat = 'identity', position = 'stack') + 
  guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "CO2 emissions in Kt CO2, \n in difference to Baseline ", title = "Fig.x Additive contribution for overall emissions variation \n Energy subventions removal with redistribution") +
  theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

rm(z,x,Legend)

```

```{r, echo = FALSE}
ggplot() + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"E"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"E_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"E_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"E_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"E_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"E_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI in % \n emission deviation to Baseline", title = "Fig.x Multiplicative contribution of energy intensity for overall emissions \n Energy subventions removal with redistribution") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

```{r, echo=FALSE}

ggplot() + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"S"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"S_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"S_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"S_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"S_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"S_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI in % \n emission deviation to Baseline", title = "Fig.x Multiplicative contribution of economy structure for overall emissions \n Energy subventions removal with redistribution") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

z <- c(Sc4[,"va_ind_2"],Sc4[,"va_trsp_2"],Sc4[,"va_ser_2"],Sc4[,"va_trsf_2"],Sc4[,"va_ele_2"])
x <- rep(Sc2[,"year"], times = 5)
Legend <- rep(c("Industry & agriculture","Transportation","Services","Energy Transformation","Electricity"), each = 36)

ggplot(
  mapping = aes(
               x = x, 
               y = z, 
               fill = Legend,
               group = 1)
               ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Added value \n variation in % to Baseline", title = "Fig.x Added value variation with regard to Baseline scenario \n Energy subventions removal scenario with redistribution") + 
      theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

rm(z,x,Legend)
```

```{r, echo=FALSE}
#energy consumption
z <- c(S2[,"ci_toe_ind_2"]-Baseline[,"ci_toe_ind_0"],S2[,"ci_toe_trsp_2"]-Baseline[,"ci_toe_trsp_0"],S2[,"ci_toe_ser_2"]-Baseline[,"ci_toe_ser_0"],S2[,"ci_toe_trsf_2"]-Baseline[,"ci_toe_trsf_0"],S2[,"ci_toe_ele_2"]-Baseline[,"ci_toe_ele_0"],S2[,"ch_toe_2"]-Baseline[,"ch_toe_0"])
x <- rep(S2[,"year"], times = 6)
Legend <- rep(c("Industry & agriculture","Transportation","Services","Energy transformation","Electricity","Household"), each = 36)

ggplot(
  mapping = aes(
               x = x, 
               y = z, 
               fill = Legend,
               group = 1)
               ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Energy consumption \n in dep difference to Baseline ", title = "Fig.X Evolution of energy comsuption by different sectors, \nthe difference with respect to Baseline scenario") + 
  theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

rm(z,x,Legend)
```

```{r, echo = FALSE}
ggplot() + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"I"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"I_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"I_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"I_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"I_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[4]][,"year"],y = Det[[4]][,"I_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI in % \n emission deviation to Baseline", title = "Fig.x Multiplicative contribution of carbon intensity for overall emissions \n nergy subventions removal scenario with redistribution") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

```{r, echo = FALSE}


BROWN <- "#AD8C97"
BROWN_DARKER <- "#7d3a46"
GREEN <- "#2FC1D3"
BLUE <- "#076FA1"
GREY <- "#C7C9CB"
GREY_DARKER <- "#5C5B5D"
RED <- "#E3120B"


Sectors <- c("Industry & agriculture","Transportation","Services","Energy transformation","Electricity","Household")

stacked_data <- data.frame(
  year = rep(S6[,"year"], times = 6),
  percent = c(Sc4[,"ci_toe_ind_2"],Sc4[,"ci_toe_trsp_2"],Sc4[,"ci_toe_ser_2"],Sc4[,"ci_toe_trsf_2"],Sc4[,"ci_toe_ele_2"],Sc4[,"ch_toe_2"]),
  Sectors = factor(rep(Sectors, each = 36), levels = rev(Sectors))
)


plt2 <- ggplot(stacked_data) +
  # color = "white" indicates the color of the lines between the areas
  geom_area(aes(year, percent, fill = fct_reorder(Sectors, abs(percent),.desc = TRUE)), position = 'identity', color = "white") +
  scale_fill_manual(values = c(GREY, BROWN, GREEN, BLUE, BROWN_DARKER, RED))+
  labs(x = "year", y = "Energy consumption \n in deviation to Baseline (%)", title = "Fig.X Evolution of energy comsuption by different sectors, \nEnergy subventions removal with redistribution") + 
      theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))+
  guides(fill=guide_legend(title="Sectors"))

plt2

```

## Renewable energy scenario

::: {align="center"}
Table.X :Macroeconomic impacts of Energy subsidies removal scenario in % deviation to Baseline
:::

```{r eval=FALSE, dev='jpeg', include=FALSE}

tablename <- c("GDP in volume","Household consumption","Investment","Exports","Imports","Household disposable income","Household consumption price index","production price index","Added value price index","Intermediate consumption price index","Export price index","Import price index","Gross nominal wage","Real cost of labor","Wage employment rate (in thousands)","Unemployment rate (in point)","Trade balance (in point of GDP)","Public budget balance (in points of GDP)","Public debt (in points of GDP)", "CO2 emissions")

Table_Macro_ENR <- S5_Macro[c("2021","2025","2030","2035","2040","2045","2050"),1:20]
Table_Macro_ENR <- t(Table_Macro_ENR)
Table_Macro_ENR <- round(Table_Macro_ENR,digits = 2)
row.names(Table_Macro_ENR) <- tablename

kable(Table_Macro_ENR, booktabs = T, longtable = T, linesep = "", caption = "Macroeconomic impacts of Carbon tax scenario in percent deviation to Baseline") %>% 
kable_styling(latex_options = c("striped","hover","repeat_header"), full_width = T) %>% 
row_spec(0, bold = T)
```

```{r, echo = FALSE}

ggplot() + 
  geom_line( aes(x = Det[[5]][,"year"],y = S5[,"ems_co2_2"]/Baseline[,"ems_co2_0"]*100 - 100, group = 1, color = "Total reduction")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"V"], group = 1, color = "Economic activities")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"S"], group = 1, color = "Economy structure")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"E"], group = 1, color = "Energy intensity")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"I"], group = 1, color = "Carbon intensity")) + 
  labs(x = "year", y = "Index LMDI \nin % deviation of emission to Baseline", title = "Fig.x Multiplicative contribution for overall emissions variation \n Renewable Energy") +
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

```{r, echo = FALSE}


z <- c(Dif[[5]][,"V"],Dif[[5]][,"S"],Dif[[5]][,"E"],Dif[[5]][,"I"])
x <- rep(Dif[[5]][,"year"], time = 4)
Legend <- rep(c("Ecnonomic activities","Economy structure","Energy intensity","Carbon intensity"), each = 36)

  ggplot() + 
  geom_bar( aes(x = x, y = z, fill = Legend, group = 1), stat = 'identity', position = 'stack') + 
  guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "CO2 emissions \n in Kt CO2 difference to Baseline ", title = "Fig.x Additive contribution for overall emissions variation \n Renewable Energy") +
  theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

rm(z,x,Legend)

```

```{r, echo = FALSE}


z <- c(Dif[[5]][,"V"],Dif[[5]][,"ind"],Dif[[5]][,"trsp"],Dif[[5]][,"ser"],Dif[[5]][,"trsf"],Dif[[5]][,"ele"])
x <- rep(Dif[[5]][,"year"], time = 6)
Legend <- rep(c("Economic activities","Industry & Agriculture","Transportation","Services","Energy Transformation","Electricity"), each = 36)

  ggplot() + 
  geom_bar( aes(x = x, y = z, fill = Legend, group = 1), stat = 'identity', position = 'stack') + 
  guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "CO2 emissions \n in Kt CO2 difference to Baseline ", title = "Fig.x Additive contribution for overall emissions variation by different sectors \n Renewable Energy") +
  theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

#rm(z,x,Legend)



```

```{r, echo = FALSE}

ggplot() + 
  geom_line( aes(x = Det[[5]][,"year"],y = (S5[,"ems_co2_2"]/Baseline[,"ems_co2_0"] - 1)*100, group = 1, color = "Total reduction")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"V"], group = 1, color = "Economic activities")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"trsf"], group = 1, color = "Energy Transformation")) +
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"ele"], group = 1, color = "Electricity")) + 
  labs(x = "year", y = "Index LMDI \nin % deviation of emission to Baseline", title = "Fig.x Multiplicative contribution for overall emissions variation by different sectors \n Renewable Energy") +
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

```{r, echo=FALSE}

ggplot() + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"S"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"S_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"S_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"S_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"S_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"S_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI \nin % deviation of emission to Baseline", title = "Fig.x Additive contribution of economy structure for overall emissions variation \n Renewable Energy") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

```{r, echo=FALSE}


ggplot() + 
  geom_line( data = Sc5, aes(x = year,y = va_2, group = 1, color = "Global effect")) + 
  geom_line( data = Sc5, aes(x = year,y = va_ind_2, group = 1, color = "Industry & agriculture")) + 
  geom_line( data = Sc5, aes(x = year,y = va_trsp_2, group = 1, color = "Transportation")) + 
  geom_line( data = Sc5, aes(x = year,y = va_ser_2, group = 1, color = "Services")) + 
  geom_line( data = Sc5, aes(x = year,y = va_trsf_2, group = 1, color = "Energy Transformation")) +
  geom_line( data = Sc5, aes(x = year,y = va_ele_2, group = 1, color = "Electricity")) +
  labs(y = "Added value \n in % deviation to Baseline", title = "Fig.x Revolution of economy structure in Tunisia \n for Renewable Energy scenario, \n expressed by added value variation with regard to Baseline scenario") +
      theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

```{r, echo = FALSE}
ggplot() + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"E"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"E_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"E_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"E_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"E_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"E_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI \n in % deviation of emission to Baseline", title = "Fig.x Multiplicative contribution of energy intensity for overall emissions \n Renewable Energy") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

```{r, echo=FALSE}
#energy consumption
z <- c(S5[,"ci_toe_ind_2"]-Baseline[,"ci_toe_ind_0"],S5[,"ci_toe_trsp_2"]-Baseline[,"ci_toe_trsp_0"],S5[,"ci_toe_ser_2"]-Baseline[,"ci_toe_ser_0"],S5[,"ci_toe_trsf_2"]-Baseline[,"ci_toe_trsf_0"],S5[,"ci_toe_ele_2"]-Baseline[,"ci_toe_ele_0"],S5[,"ch_toe_2"]-Baseline[,"ch_toe_0"])
x <- rep(S5[,"year"], times = 6)
Legend <- rep(c("Industry & agriculture","Transportation","Services","Energy transformation","Electricity","Household"), each = 36)

ggplot(
  mapping = aes(
               x = x, 
               y = z, 
               fill = Legend,
               group = 1)
               ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Energy consumption \n in tep difference to Baseline ", title = "Fig.X Evolution of energy comsuption by different sectors, \n Renewable energy scenario, \nthe difference with respect to Baseline scenario") + 
  theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

rm(z,x,Legend)
```

```{r, echo = FALSE}
ggplot() + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"I"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"I_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"I_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"I_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"I_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[5]][,"I_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI \n in % deviation of emission to Baseline", title = "Fig.x Multiplicative contribution of carbon intensity for overall emissions \n Renewable Energy") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

## National Low-Carbon Strategy scenario

::: {align="center"}
Table.X :Macroeconomic impacts of Nation Low-Carbon Strategy scenario in % deviation to Baseline
:::

```{r dev='jpeg', include=FALSE}

tablename <- c("GDP in volume","Household consumption","Investment","Exports","Imports","Household disposable income","Household consumption price index","production price index","Added value price index","Intermediate consumption price index","Export price index","Import price index","Gross nominal wage","Real cost of labor","Wage employment rate (in thousands)","Unemployment rate (in point)","Trade balance (in point of GDP)","Public budget balance (in points of GDP)","Public debt (in points of GDP)", "CO2 emissions")

Table_Macro_SNBC <- S6_Macro[c("2021","2025","2030","2035","2040","2045","2050"),1:20]
Table_Macro_SNBC <- t(Table_Macro_SNBC)
Table_Macro_ENR <- round(Table_Macro_SNBC,digits = 2)
row.names(Table_Macro_SNBC) <- tablename

kable(Table_Macro_SNBC, booktabs = T, longtable = T, linesep = "", caption = "Macroeconomic impacts of Nation Low-Carbon Strategy scenario in percent deviation to Baseline") %>% 
kable_styling(latex_options = c("striped","hover","repeat_header"), full_width = T) %>% 
row_spec(0, bold = T)
```

```{r, echo = FALSE}

ggplot() + 
  geom_line( aes(x = Det[[6]][,"year"],y = S6[,"ems_ci_co2_2"]/Baseline[,"ems_ci_co2_0"]*100 - 100, group = 1, color = "Total reduction")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"V"], group = 1, color = "Economic activities")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"S"], group = 1, color = "Economy structure")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"E"], group = 1, color = "Energy intensity")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"I"], group = 1, color = "Carbon intensity")) + 
  labs(x = "year", y = "Index LMDI \nin % deviation of emission to Baseline", title = "Fig.x Multiplicative contribution for overall emissions variation \n SNBC") +
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

```{r, echo = FALSE}


z <- c(Dif[[6]][,"V"],Dif[[6]][,"S"],Dif[[6]][,"E"],Dif[[6]][,"I"])
x <- rep(Dif[[6]][,"year"], time = 4)
Legend <- rep(c("Ecnonomic activities","Economy structure","Energy intensity","Carbon intensity"), each = 36)

  ggplot() + 
  geom_bar( aes(x = x, y = z, fill = Legend, group = 1), stat = 'identity', position = 'stack') + 
  guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "CO2 emissions \n in Kt CO2 difference to Baseline ", title = "Fig.x Additive contribution for overall emissions variation \n SNBC") +
  theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

rm(z,x,Legend)

```

```{r, echo = FALSE}

z <- c(Dif[[6]][,"V"],Dif[[6]][,"ind"],Dif[[6]][,"trsp"],Dif[[6]][,"ser"],Dif[[5]][,"trsf"],Dif[[6]][,"ele"])
x <- rep(Dif[[6]][,"year"], time = 6)
Legend <- rep(c("Economic activities","Industry & Agriculture","Transportation","Services","Energy Transformation","Electricity"), each = 36)

  ggplot() + 
  geom_bar( aes(x = x, y = z, fill = Legend, group = 1), stat = 'identity', position = 'stack') + 
  guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "CO2 emissions \n in Kt CO2 difference to Baseline ", title = "Fig.x Additive contribution for overall emissions variation by different sectors \n SNBC") +
  theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

rm(z,x,Legend)

```

```{r, echo=FALSE}

ggplot() + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[6]][,"S"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[6]][,"S_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[6]][,"S_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[6]][,"S_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[6]][,"S_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[6]][,"S_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI \nin % deviation of emission to Baseline", title = "Fig.x Additive contribution of economy structure for overall emissions variation \n SNBC") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

```

```{r, echo = FALSE}
ggplot() + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[6]][,"E"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[6]][,"E_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[6]][,"E_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[6]][,"E_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[6]][,"E_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[5]][,"year"],y = Det[[6]][,"E_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI \n in % deviation of emission to Baseline", title = "Fig.x Multiplicative contribution of energy intensity for overall emissions \n SNBC") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

```{r, echo=FALSE}
#energy consumption
z <- c(S6[,"ci_toe_ind_2"]-Baseline[,"ci_toe_ind_0"],S6[,"ci_toe_trsp_2"]-Baseline[,"ci_toe_trsp_0"],S6[,"ci_toe_ser_2"]-Baseline[,"ci_toe_ser_0"],S6[,"ci_toe_trsf_2"]-Baseline[,"ci_toe_trsf_0"],S6[,"ci_toe_ele_2"]-Baseline[,"ci_toe_ele_0"],S6[,"ch_toe_2"]-Baseline[,"ch_toe_0"])
x <- rep(S6[,"year"], times = 6)
Legend <- rep(c("Industry & agriculture","Transportation","Services","Energy transformation","Electricity","Household"), each = 36)

ggplot(
  mapping = aes(
               x = x, 
               y = z, 
               fill = Legend,
               group = 1)
               ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Energy consumption \n in tep difference to Baseline ", title = "Fig.X Evolution of energy comsuption by different sectors, \nthe difference with respect to Baseline scenario") + 
  theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

rm(z,x,Legend)
```

```{r, echo = FALSE}
ggplot() + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"I"], group = 1, color = "Total effect")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"I_ind"], group = 1, color = "Industry & Agriculture")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"I_trsp"], group = 1, color = "Transportation")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"I_ser"], group = 1, color = "Services")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"I_trsf"], group = 1, color = "Energy Transformation")) + 
  geom_line( aes(x = Det[[6]][,"year"],y = Det[[6]][,"I_ele"], group = 1, color = "Electricity")) +
  labs(x = "year", y = "Index LMDI \n in % deviation of emission to Baseline", title = "Fig.x Multiplicative contribution of carbon intensity for overall emissions \n SNBC") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))
```

```{r, echo = FALSE}
z_1 <- c(
       S6[,"ci_toe_cfut_ind_2"]/S6[,"ci_toe_ind_2"],
       S6[,"ci_toe_cfuh_ind_2"]/S6[,"ci_toe_ind_2"],
       S6[,"ci_toe_cgas_ind_2"]/S6[,"ci_toe_ind_2"],
       S6[,"ci_toe_cele_ind_2"]/S6[,"ci_toe_ind_2"])
x_1 <- rep(Baseline[,"year"], times = 4)
Legend <- rep(c("Fuels for transportation","Fuels for other use","Natural gas","Electricity"), each = 36)

Fig.1 <-
  ggplot(
  mapping = aes(
                x = x_1, 
                y = z_1, 
                fill = Legend,
                group = 1)
  ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Share of energy consumption", title = "Fig.x Energy mix of Industry & Agriculture for SNBC scenario") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

z_2 <- c(
       Baseline[,"ci_toe_cfut_ind_0"]/Baseline[,"ci_toe_ind_0"],
       Baseline[,"ci_toe_cfuh_ind_0"]/Baseline[,"ci_toe_ind_0"],
       Baseline[,"ci_toe_cgas_ind_0"]/Baseline[,"ci_toe_ind_0"],
       Baseline[,"ci_toe_cele_ind_0"]/Baseline[,"ci_toe_ind_0"])
x_2 <- rep(Baseline[,"year"], times = 4)
Legend <- rep(c("Fuels for transportation","Fuels for other use","Natural gas","Electricity"), each = 36)

Fig.2 <-
  ggplot(
  mapping = aes(
                x = x_2, 
                y = z_2, 
                fill = Legend,
                group = 1)
  ) + 
  geom_bar(stat = 'identity', position = 'stack') + guides(fill = guide_legend(reverse = TRUE)) + 
  labs(x = "year", y = "Share of energy consumption", title = "Fig.x Energy mix of Industry & Agriculture for Baseline scenario") + 
    theme(axis.title=element_text(size=9),title = element_text(size=9), plot.title = element_text(hjust = 0.5, vjust = 0.5)) +
  scale_x_continuous(breaks=seq(2015,2050,5))

ggarrange(Fig.1, Fig.2, ncol = 1, common.legend = T, legend = "right")

```

# Prolongements

## D'autres leviers pour analyser (ouverture)

## L'amélioration du cadre statistique

OUverture : pb du secteur informel non pris en compte par la comptabilité nationale

# Conclusion

# Bibliographie
